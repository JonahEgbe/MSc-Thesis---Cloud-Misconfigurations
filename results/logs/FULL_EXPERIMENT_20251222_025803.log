============================================================
EXPERIMENT START: 2025-12-22 02:58:03 UTC
ROOT_DIR: /workspaces/MSc-Thesis---Cloud-Misconfigurations
TEST_SUITE_DIR: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite
RESULTS_DIR: /workspaces/MSc-Thesis---Cloud-Misconfigurations/results
EXPERIMENT_LOG: /workspaces/MSc-Thesis---Cloud-Misconfigurations/results/logs/FULL_EXPERIMENT_20251222_025803.log
============================================================

==> Discovering scenarios (folders containing scenario.json)...
==> Found 26 scenarios.

============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-001-ssm-enabled-on-ec2
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-001-ssm-enabled-on-ec2

============================================================
FULL SCAN LOG START: 2025-12-22 02:58:03 UTC
Scenario: CMP-BENIGN-001-ssm-enabled-on-ec2
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-001-ssm-enabled-on-ec2
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====
[0m[1mdata.aws_ami.al2: Reading...[0m[0m
[0m[1mdata.aws_ami.al2: Read complete after 1s [id=ami-0ad8de99ac93341e7][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_iam_instance_profile.profile[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_instance_profile" "profile" {
      [32m+[0m[0m arn         = (known after apply)
      [32m+[0m[0m create_date = (known after apply)
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m name        = (known after apply)
      [32m+[0m[0m name_prefix = (known after apply)
      [32m+[0m[0m path        = "/"
      [32m+[0m[0m role        = (known after apply)
      [32m+[0m[0m tags        = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all    = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m unique_id   = (known after apply)
    }

[1m  # aws_iam_role.ssm_role[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_role" "ssm_role" {
      [32m+[0m[0m arn                   = (known after apply)
      [32m+[0m[0m assume_role_policy    = jsonencode(
            {
              [32m+[0m[0m Statement = [
                  [32m+[0m[0m {
                      [32m+[0m[0m Action    = "sts:AssumeRole"
                      [32m+[0m[0m Effect    = "Allow"
                      [32m+[0m[0m Principal = {
                          [32m+[0m[0m Service = "ec2.amazonaws.com"
                        }
                    },
                ]
              [32m+[0m[0m Version   = "2012-10-17"
            }
        )
      [32m+[0m[0m create_date           = (known after apply)
      [32m+[0m[0m force_detach_policies = false
      [32m+[0m[0m id                    = (known after apply)
      [32m+[0m[0m managed_policy_arns   = (known after apply)
      [32m+[0m[0m max_session_duration  = 3600
      [32m+[0m[0m name                  = (known after apply)
      [32m+[0m[0m name_prefix           = (known after apply)
      [32m+[0m[0m path                  = "/"
      [32m+[0m[0m tags                  = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all              = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m unique_id             = (known after apply)

      [32m+[0m[0m inline_policy (known after apply)
    }

[1m  # aws_iam_role_policy_attachment.ssm_core[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_role_policy_attachment" "ssm_core" {
      [32m+[0m[0m id         = (known after apply)
      [32m+[0m[0m policy_arn = "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
      [32m+[0m[0m role       = (known after apply)
    }

[1m  # aws_instance.ec2[0m will be created
[0m  [32m+[0m[0m resource "aws_instance" "ec2" {
      [32m+[0m[0m ami                                  = "ami-0ad8de99ac93341e7"
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m associate_public_ip_address          = false
      [32m+[0m[0m availability_zone                    = (known after apply)
      [32m+[0m[0m cpu_core_count                       = (known after apply)
      [32m+[0m[0m cpu_threads_per_core                 = (known after apply)
      [32m+[0m[0m disable_api_stop                     = (known after apply)
      [32m+[0m[0m disable_api_termination              = (known after apply)
      [32m+[0m[0m ebs_optimized                        = (known after apply)
      [32m+[0m[0m enable_primary_ipv6                  = (known after apply)
      [32m+[0m[0m get_password_data                    = false
      [32m+[0m[0m host_id                              = (known after apply)
      [32m+[0m[0m host_resource_group_arn              = (known after apply)
      [32m+[0m[0m iam_instance_profile                 = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_initiated_shutdown_behavior = (known after apply)
      [32m+[0m[0m instance_lifecycle                   = (known after apply)
      [32m+[0m[0m instance_state                       = (known after apply)
      [32m+[0m[0m instance_type                        = "t3.micro"
      [32m+[0m[0m ipv6_address_count                   = (known after apply)
      [32m+[0m[0m ipv6_addresses                       = (known after apply)
      [32m+[0m[0m key_name                             = (known after apply)
      [32m+[0m[0m monitoring                           = (known after apply)
      [32m+[0m[0m outpost_arn                          = (known after apply)
      [32m+[0m[0m password_data                        = (known after apply)
      [32m+[0m[0m placement_group                      = (known after apply)
      [32m+[0m[0m placement_partition_number           = (known after apply)
      [32m+[0m[0m primary_network_interface_id         = (known after apply)
      [32m+[0m[0m private_dns                          = (known after apply)
      [32m+[0m[0m private_ip                           = (known after apply)
      [32m+[0m[0m public_dns                           = (known after apply)
      [32m+[0m[0m public_ip                            = (known after apply)
      [32m+[0m[0m secondary_private_ips                = (known after apply)
      [32m+[0m[0m security_groups                      = (known after apply)
      [32m+[0m[0m source_dest_check                    = true
      [32m+[0m[0m spot_instance_request_id             = (known after apply)
      [32m+[0m[0m subnet_id                            = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tenancy                              = (known after apply)
      [32m+[0m[0m user_data                            = (known after apply)
      [32m+[0m[0m user_data_base64                     = (known after apply)
      [32m+[0m[0m user_data_replace_on_change          = false
      [32m+[0m[0m vpc_security_group_ids               = (known after apply)

      [32m+[0m[0m capacity_reservation_specification (known after apply)

      [32m+[0m[0m cpu_options (known after apply)

      [32m+[0m[0m ebs_block_device (known after apply)

      [32m+[0m[0m enclave_options (known after apply)

      [32m+[0m[0m ephemeral_block_device (known after apply)

      [32m+[0m[0m instance_market_options (known after apply)

      [32m+[0m[0m maintenance_options (known after apply)

      [32m+[0m[0m metadata_options (known after apply)

      [32m+[0m[0m network_interface (known after apply)

      [32m+[0m[0m private_dns_name_options (known after apply)

      [32m+[0m[0m root_block_device (known after apply)
    }

[1m  # aws_security_group.sg[0m will be created
[0m  [32m+[0m[0m resource "aws_security_group" "sg" {
      [32m+[0m[0m arn                    = (known after apply)
      [32m+[0m[0m description            = "Managed by Terraform"
      [32m+[0m[0m egress                 = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "0.0.0.0/0",
                ]
              [32m+[0m[0m from_port        = 0
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "-1"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 0
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m id                     = (known after apply)
      [32m+[0m[0m ingress                = (known after apply)
      [32m+[0m[0m name                   = (known after apply)
      [32m+[0m[0m name_prefix            = (known after apply)
      [32m+[0m[0m owner_id               = (known after apply)
      [32m+[0m[0m revoke_rules_on_delete = false
      [32m+[0m[0m tags                   = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all               = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m vpc_id                 = (known after apply)
    }

[1m  # aws_subnet.private[0m will be created
[0m  [32m+[0m[0m resource "aws_subnet" "private" {
      [32m+[0m[0m arn                                            = (known after apply)
      [32m+[0m[0m assign_ipv6_address_on_creation                = false
      [32m+[0m[0m availability_zone                              = "eu-west-2a"
      [32m+[0m[0m availability_zone_id                           = (known after apply)
      [32m+[0m[0m cidr_block                                     = "10.61.1.0/24"
      [32m+[0m[0m enable_dns64                                   = false
      [32m+[0m[0m enable_resource_name_dns_a_record_on_launch    = false
      [32m+[0m[0m enable_resource_name_dns_aaaa_record_on_launch = false
      [32m+[0m[0m id                                             = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_association_id                 = (known after apply)
      [32m+[0m[0m ipv6_native                                    = false
      [32m+[0m[0m map_public_ip_on_launch                        = false
      [32m+[0m[0m owner_id                                       = (known after apply)
      [32m+[0m[0m private_dns_hostname_type_on_launch            = (known after apply)
      [32m+[0m[0m tags                                           = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                                       = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m vpc_id                                         = (known after apply)
    }

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.61.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-001-ssm-enabled-on-ec2"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m8 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 16, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private
	File: /main.tf:19-25
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.ssm_role
	File: /main.tf:40-53
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.ssm_role
	File: /main.tf:40-53
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.ssm_role
	File: /main.tf:40-53
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.ssm_core
	File: /main.tf:55-58
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:66-76
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /main.tf:66-76
Check: CKV_AWS_386: "Reduce potential for WhoAMI cloud image name confusion attack"
	PASSED for resource: aws_ami.al2
	File: /main.tf:3-10
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.ssm_core
	File: /main.tf:55-58
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:66-76
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:27-38

		27 | resource "aws_security_group" "sg" {
		28 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		29 |   vpc_id = aws_vpc.vpc.id
		30 |   tags   = local.common_tags
		31 | 
		32 |   egress {
		33 |     from_port   = 0
		34 |     to_port     = 0
		35 |     protocol    = "-1"
		36 |     cidr_blocks = ["0.0.0.0/0"]
		37 |   }
		38 | }

Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:27-38

		27 | resource "aws_security_group" "sg" {
		28 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		29 |   vpc_id = aws_vpc.vpc.id
		30 |   tags   = local.common_tags
		31 | 
		32 |   egress {
		33 |     from_port   = 0
		34 |     to_port     = 0
		35 |     protocol    = "-1"
		36 |     cidr_blocks = ["0.0.0.0/0"]
		37 |   }
		38 | }

Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:66-76

		66 | resource "aws_instance" "ec2" {
		67 |   ami                         = data.aws_ami.al2.id
		68 |   instance_type               = "t3.micro"
		69 |   subnet_id                   = aws_subnet.private.id
		70 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		71 |   associate_public_ip_address = false
		72 | 
		73 |   iam_instance_profile = aws_iam_instance_profile.profile.name
		74 | 
		75 |   tags = local.common_tags
		76 | }

Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:66-76

		66 | resource "aws_instance" "ec2" {
		67 |   ami                         = data.aws_ami.al2.id
		68 |   instance_type               = "t3.micro"
		69 |   subnet_id                   = aws_subnet.private.id
		70 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		71 |   associate_public_ip_address = false
		72 | 
		73 |   iam_instance_profile = aws_iam_instance_profile.profile.name
		74 | 
		75 |   tags = local.common_tags
		76 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:66-76

		66 | resource "aws_instance" "ec2" {
		67 |   ami                         = data.aws_ami.al2.id
		68 |   instance_type               = "t3.micro"
		69 |   subnet_id                   = aws_subnet.private.id
		70 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		71 |   associate_public_ip_address = false
		72 | 
		73 |   iam_instance_profile = aws_iam_instance_profile.profile.name
		74 | 
		75 |   tags = local.common_tags
		76 | }

Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:66-76

		66 | resource "aws_instance" "ec2" {
		67 |   ami                         = data.aws_ami.al2.id
		68 |   instance_type               = "t3.micro"
		69 |   subnet_id                   = aws_subnet.private.id
		70 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		71 |   associate_public_ip_address = false
		72 | 
		73 |   iam_instance_profile = aws_iam_instance_profile.profile.name
		74 | 
		75 |   tags = local.common_tags
		76 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:12-17

		12 | resource "aws_vpc" "vpc" {
		13 |   cidr_block           = "10.61.0.0/16"
		14 |   enable_dns_support   = true
		15 |   enable_dns_hostnames = true
		16 |   tags                 = local.common_tags
		17 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:12-17

		12 | resource "aws_vpc" "vpc" {
		13 |   cidr_block           = "10.61.0.0/16"
		14 |   enable_dns_support   = true
		15 |   enable_dns_hostnames = true
		16 |   tags                 = local.common_tags
		17 | }

terraform_plan scan results:

Passed checks: 17, Failed checks: 7, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.ssm_role
	File: /tfplan.json:0-0
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.ssm_role
	File: /tfplan.json:0-0
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.ssm_role
	File: /tfplan.json:0-0
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role_policy_attachment.ssm_core
	File: /tfplan.json:0-0
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private
	File: /tfplan.json:0-0
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.ssm_role
	File: /tfplan.json:0-0
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role_policy_attachment.ssm_core
	File: /tfplan.json:0-0
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows egress to multiple public internet addresses.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:36
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   27  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   36  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m   ..  [0m
[0m[90m   38  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-egress-sgr
[0m[0m  [2m    Impact[0m Your port is egressing data to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mInstance does not require IMDS access to require a token[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:66-76
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   66  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   67  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mami[0m                         = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   68  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245minstance_type[0m               = [38;5;37m"t3.micro"[0m
[0m[31m   69  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245msubnet_id[0m                   = aws_subnet.private.id[0m
[0m[31m   70  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_security_group_ids[0m      = [aws_security_group.sg.id][0m
[0m[31m   71  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245massociate_public_ip_address[0m = [38;5;166mfalse[0m
[0m[31m   72  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   73  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245miam_instance_profile[0m = aws_iam_instance_profile.profile.name[0m
[0m[31m   74  [0m[0m[31mâ””[39m[0m[0m [0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enforce-http-token-imds
[0m[0m  [2m    Impact[0m Instance metadata service can be interacted with freely
[0m[0m  [2mResolution[0m Enable HTTP token requirement for IMDS
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mRoot block device is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:66-76
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   66  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   67  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mami[0m                         = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   68  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245minstance_type[0m               = [38;5;37m"t3.micro"[0m
[0m[31m   69  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245msubnet_id[0m                   = aws_subnet.private.id[0m
[0m[31m   70  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_security_group_ids[0m      = [aws_security_group.sg.id][0m
[0m[31m   71  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245massociate_public_ip_address[0m = [38;5;166mfalse[0m
[0m[31m   72  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   73  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245miam_instance_profile[0m = aws_iam_instance_profile.profile.name[0m
[0m[31m   74  [0m[0m[31mâ””[39m[0m[0m [0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m The block device could be compromised and read from
[0m[0m  [2mResolution[0m Turn on encryption for all block devices
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[33mMEDIUM[39m[0m [1mVPC Flow Logs is not enabled for VPC [0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:12-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   12  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_vpc"[0m [38;5;37m"vpc"[0m {[0m
[0m[31m   13  [0m[0m [0m[0m   [38;5;245mcidr_block[0m           = [38;5;37m"10.61.0.0/16"[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_dns_support[0m   = [38;5;166mtrue[0m
[0m[31m   15  [0m[0m [0m[0m [0m  [38;5;245menable_dns_hostnames[0m = [38;5;166mtrue[0m
[0m[31m   16  [0m[0m [0m[0m [0m  [38;5;245mtags[0m                 = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-require-vpc-flow-logs-for-all-vpcs
[0m[0m  [2m    Impact[0m Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
[0m[0m  [2mResolution[0m Enable flow logs for VPC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[97mLOW[39m[0m [1mSecurity group explicitly uses the default description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:27-38
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   27  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[31m   28  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   29  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[31m   30  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mtags[0m   = local.common_tags[0m
[0m[31m   31  [0m[0m[31mâ”‚[39m[0m[0m [0m
[0m[31m   32  [0m[0m[31mâ”‚[39m[0m[0m   egress {[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   34  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   35  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:32-37
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   27  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   28  [0m[0m    [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[90m   29  [0m[0m    [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[90m   30  [0m[0m    [38;5;245mtags[0m   = local.common_tags[0m
[0m[90m   31  [0m[0m  [0m
[0m[31m   32  [0m[0m[31mâ”Œ[39m[0m[0m   egress {[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   34  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   35  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 64.03Âµs
[0m[0m  [2mparsing             [0m 2.338129ms
[0m[0m  [2madaptation          [0m 168.153Âµs
[0m[0m  [2mchecks              [0m 9.457116ms
[0m[0m  [2mtotal               [0m 12.027428ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 18
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 1
[0m[0m  [2mhigh                [0m 2
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 2
[0m
[0m  [31m[1m2 passed, 6 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)
[31mFAIL[0m - tfplan.json - main - Security Group aws_security_group.sg has unrestricted egress to 0.0.0.0/0 (review / high-risk)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:58:24 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-001-ssm-enabled-on-ec2/scan_logs/FULL_CMP-BENIGN-001-ssm-enabled-on-ec2.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-002-imdsv2-required
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-002-imdsv2-required

============================================================
FULL SCAN LOG START: 2025-12-22 02:58:24 UTC
Scenario: CMP-BENIGN-002-imdsv2-required
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-002-imdsv2-required
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====
[0m[1mdata.aws_ami.al2: Reading...[0m[0m
[0m[1mdata.aws_ami.al2: Read complete after 0s [id=ami-0ad8de99ac93341e7][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_instance.ec2[0m will be created
[0m  [32m+[0m[0m resource "aws_instance" "ec2" {
      [32m+[0m[0m ami                                  = "ami-0ad8de99ac93341e7"
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m associate_public_ip_address          = (known after apply)
      [32m+[0m[0m availability_zone                    = (known after apply)
      [32m+[0m[0m cpu_core_count                       = (known after apply)
      [32m+[0m[0m cpu_threads_per_core                 = (known after apply)
      [32m+[0m[0m disable_api_stop                     = (known after apply)
      [32m+[0m[0m disable_api_termination              = (known after apply)
      [32m+[0m[0m ebs_optimized                        = (known after apply)
      [32m+[0m[0m enable_primary_ipv6                  = (known after apply)
      [32m+[0m[0m get_password_data                    = false
      [32m+[0m[0m host_id                              = (known after apply)
      [32m+[0m[0m host_resource_group_arn              = (known after apply)
      [32m+[0m[0m iam_instance_profile                 = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_initiated_shutdown_behavior = (known after apply)
      [32m+[0m[0m instance_lifecycle                   = (known after apply)
      [32m+[0m[0m instance_state                       = (known after apply)
      [32m+[0m[0m instance_type                        = "t3.micro"
      [32m+[0m[0m ipv6_address_count                   = (known after apply)
      [32m+[0m[0m ipv6_addresses                       = (known after apply)
      [32m+[0m[0m key_name                             = (known after apply)
      [32m+[0m[0m monitoring                           = (known after apply)
      [32m+[0m[0m outpost_arn                          = (known after apply)
      [32m+[0m[0m password_data                        = (known after apply)
      [32m+[0m[0m placement_group                      = (known after apply)
      [32m+[0m[0m placement_partition_number           = (known after apply)
      [32m+[0m[0m primary_network_interface_id         = (known after apply)
      [32m+[0m[0m private_dns                          = (known after apply)
      [32m+[0m[0m private_ip                           = (known after apply)
      [32m+[0m[0m public_dns                           = (known after apply)
      [32m+[0m[0m public_ip                            = (known after apply)
      [32m+[0m[0m secondary_private_ips                = (known after apply)
      [32m+[0m[0m security_groups                      = (known after apply)
      [32m+[0m[0m source_dest_check                    = true
      [32m+[0m[0m spot_instance_request_id             = (known after apply)
      [32m+[0m[0m subnet_id                            = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "EC2.8"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-002-imdsv2-required"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "EC2.8"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-BENIGN-002-imdsv2-required"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tenancy                              = (known after apply)
      [32m+[0m[0m user_data                            = (known after apply)
      [32m+[0m[0m user_data_base64                     = (known after apply)
      [32m+[0m[0m user_data_replace_on_change          = false
      [32m+[0m[0m vpc_security_group_ids               = (known after apply)

      [32m+[0m[0m capacity_reservation_specification (known after apply)

      [32m+[0m[0m cpu_options (known after apply)

      [32m+[0m[0m ebs_block_device (known after apply)

      [32m+[0m[0m enclave_options (known after apply)

      [32m+[0m[0m ephemeral_block_device (known after apply)

      [32m+[0m[0m instance_market_options (known after apply)

      [32m+[0m[0m maintenance_options (known after apply)

      [32m+[0m[0m metadata_options {
          [32m+[0m[0m http_endpoint               = "enabled"
          [32m+[0m[0m http_protocol_ipv6          = "disabled"
          [32m+[0m[0m http_put_response_hop_limit = (known after apply)
          [32m+[0m[0m http_tokens                 = "required"
          [32m+[0m[0m instance_metadata_tags      = (known after apply)
        }

      [32m+[0m[0m network_interface (known after apply)

      [32m+[0m[0m private_dns_name_options (known after apply)

      [32m+[0m[0m root_block_device (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 5, Failed checks: 4, Skipped checks: 0

Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:12-21
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:12-21
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /main.tf:12-21
Check: CKV_AWS_386: "Reduce potential for WhoAMI cloud image name confusion attack"
	PASSED for resource: aws_ami.al2
	File: /main.tf:3-10
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "required"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "required"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "required"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "required"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

terraform_plan scan results:

Passed checks: 4, Failed checks: 4, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mRoot block device is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:12-21
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   12  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   13  [0m[0m [0m[0m   [38;5;245mami[0m           = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   14  [0m[0m [0m[0m   [38;5;245minstance_type[0m = [38;5;37m"t3.micro"[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   metadata_options {[0m
[0m[31m   17  [0m[0m [0m[0m     [38;5;245mhttp_tokens[0m = [38;5;37m"required"[0m
[0m[31m   18  [0m[0m [0m[0m [0m  }[0m
[0m[31m   19  [0m[0m [0m[0m [0m
[0m[31m   20  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   21  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m The block device could be compromised and read from
[0m[0m  [2mResolution[0m Turn on encryption for all block devices
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 57.394Âµs
[0m[0m  [2mparsing             [0m 819.166Âµs
[0m[0m  [2madaptation          [0m 120.887Âµs
[0m[0m  [2mchecks              [0m 8.605963ms
[0m[0m  [2mtotal               [0m 9.60341ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m2 passed, 1 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:58:44 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-BENIGN-002-imdsv2-required/scan_logs/FULL_CMP-BENIGN-002-imdsv2-required.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-001-ssm-disabled-on-ec2
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-001-ssm-disabled-on-ec2

============================================================
FULL SCAN LOG START: 2025-12-22 02:58:44 UTC
Scenario: CMP-MISC-001-ssm-disabled-on-ec2
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-001-ssm-disabled-on-ec2
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====
[0m[1mdata.aws_ami.al2: Reading...[0m[0m
[0m[1mdata.aws_ami.al2: Read complete after 0s [id=ami-0ad8de99ac93341e7][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_instance.ec2[0m will be created
[0m  [32m+[0m[0m resource "aws_instance" "ec2" {
      [32m+[0m[0m ami                                  = "ami-0ad8de99ac93341e7"
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m associate_public_ip_address          = false
      [32m+[0m[0m availability_zone                    = (known after apply)
      [32m+[0m[0m cpu_core_count                       = (known after apply)
      [32m+[0m[0m cpu_threads_per_core                 = (known after apply)
      [32m+[0m[0m disable_api_stop                     = (known after apply)
      [32m+[0m[0m disable_api_termination              = (known after apply)
      [32m+[0m[0m ebs_optimized                        = (known after apply)
      [32m+[0m[0m enable_primary_ipv6                  = (known after apply)
      [32m+[0m[0m get_password_data                    = false
      [32m+[0m[0m host_id                              = (known after apply)
      [32m+[0m[0m host_resource_group_arn              = (known after apply)
      [32m+[0m[0m iam_instance_profile                 = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_initiated_shutdown_behavior = (known after apply)
      [32m+[0m[0m instance_lifecycle                   = (known after apply)
      [32m+[0m[0m instance_state                       = (known after apply)
      [32m+[0m[0m instance_type                        = "t3.micro"
      [32m+[0m[0m ipv6_address_count                   = (known after apply)
      [32m+[0m[0m ipv6_addresses                       = (known after apply)
      [32m+[0m[0m key_name                             = (known after apply)
      [32m+[0m[0m monitoring                           = (known after apply)
      [32m+[0m[0m outpost_arn                          = (known after apply)
      [32m+[0m[0m password_data                        = (known after apply)
      [32m+[0m[0m placement_group                      = (known after apply)
      [32m+[0m[0m placement_partition_number           = (known after apply)
      [32m+[0m[0m primary_network_interface_id         = (known after apply)
      [32m+[0m[0m private_dns                          = (known after apply)
      [32m+[0m[0m private_ip                           = (known after apply)
      [32m+[0m[0m public_dns                           = (known after apply)
      [32m+[0m[0m public_ip                            = (known after apply)
      [32m+[0m[0m secondary_private_ips                = (known after apply)
      [32m+[0m[0m security_groups                      = (known after apply)
      [32m+[0m[0m source_dest_check                    = true
      [32m+[0m[0m spot_instance_request_id             = (known after apply)
      [32m+[0m[0m subnet_id                            = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tenancy                              = (known after apply)
      [32m+[0m[0m user_data                            = (known after apply)
      [32m+[0m[0m user_data_base64                     = (known after apply)
      [32m+[0m[0m user_data_replace_on_change          = false
      [32m+[0m[0m vpc_security_group_ids               = (known after apply)

      [32m+[0m[0m capacity_reservation_specification (known after apply)

      [32m+[0m[0m cpu_options (known after apply)

      [32m+[0m[0m ebs_block_device (known after apply)

      [32m+[0m[0m enclave_options (known after apply)

      [32m+[0m[0m ephemeral_block_device (known after apply)

      [32m+[0m[0m instance_market_options (known after apply)

      [32m+[0m[0m maintenance_options (known after apply)

      [32m+[0m[0m metadata_options (known after apply)

      [32m+[0m[0m network_interface (known after apply)

      [32m+[0m[0m private_dns_name_options (known after apply)

      [32m+[0m[0m root_block_device (known after apply)
    }

[1m  # aws_security_group.sg[0m will be created
[0m  [32m+[0m[0m resource "aws_security_group" "sg" {
      [32m+[0m[0m arn                    = (known after apply)
      [32m+[0m[0m description            = "Managed by Terraform"
      [32m+[0m[0m egress                 = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "0.0.0.0/0",
                ]
              [32m+[0m[0m from_port        = 0
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "-1"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 0
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m id                     = (known after apply)
      [32m+[0m[0m ingress                = (known after apply)
      [32m+[0m[0m name                   = (known after apply)
      [32m+[0m[0m name_prefix            = (known after apply)
      [32m+[0m[0m owner_id               = (known after apply)
      [32m+[0m[0m revoke_rules_on_delete = false
      [32m+[0m[0m tags                   = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all               = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m vpc_id                 = (known after apply)
    }

[1m  # aws_subnet.private[0m will be created
[0m  [32m+[0m[0m resource "aws_subnet" "private" {
      [32m+[0m[0m arn                                            = (known after apply)
      [32m+[0m[0m assign_ipv6_address_on_creation                = false
      [32m+[0m[0m availability_zone                              = "eu-west-2a"
      [32m+[0m[0m availability_zone_id                           = (known after apply)
      [32m+[0m[0m cidr_block                                     = "10.60.1.0/24"
      [32m+[0m[0m enable_dns64                                   = false
      [32m+[0m[0m enable_resource_name_dns_a_record_on_launch    = false
      [32m+[0m[0m enable_resource_name_dns_aaaa_record_on_launch = false
      [32m+[0m[0m id                                             = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_association_id                 = (known after apply)
      [32m+[0m[0m ipv6_native                                    = false
      [32m+[0m[0m map_public_ip_on_launch                        = false
      [32m+[0m[0m owner_id                                       = (known after apply)
      [32m+[0m[0m private_dns_hostname_type_on_launch            = (known after apply)
      [32m+[0m[0m tags                                           = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                                       = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m vpc_id                                         = (known after apply)
    }

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.60.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "SSM.1"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-001-ssm-disabled-on-ec2"
          [32m+[0m[0m "type"         = "MISC"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m5 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 10, Failed checks: 9, Skipped checks: 0

Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private
	File: /main.tf:19-25
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:40-49
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /main.tf:40-49
Check: CKV_AWS_386: "Reduce potential for WhoAMI cloud image name confusion attack"
	PASSED for resource: aws_ami.al2
	File: /main.tf:3-10
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:27-38
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:27-38

		27 | resource "aws_security_group" "sg" {
		28 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		29 |   vpc_id = aws_vpc.vpc.id
		30 |   tags   = local.common_tags
		31 | 
		32 |   egress {
		33 |     from_port   = 0
		34 |     to_port     = 0
		35 |     protocol    = "-1"
		36 |     cidr_blocks = ["0.0.0.0/0"]
		37 |   }
		38 | }

Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:27-38

		27 | resource "aws_security_group" "sg" {
		28 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		29 |   vpc_id = aws_vpc.vpc.id
		30 |   tags   = local.common_tags
		31 | 
		32 |   egress {
		33 |     from_port   = 0
		34 |     to_port     = 0
		35 |     protocol    = "-1"
		36 |     cidr_blocks = ["0.0.0.0/0"]
		37 |   }
		38 | }

Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:40-49

		40 | resource "aws_instance" "ec2" {
		41 |   ami                         = data.aws_ami.al2.id
		42 |   instance_type               = "t3.micro"
		43 |   subnet_id                   = aws_subnet.private.id
		44 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		45 |   associate_public_ip_address = false
		46 | 
		47 |   # Intentionally NO iam_instance_profile (SSM disabled)
		48 |   tags = local.common_tags
		49 | }

Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:40-49

		40 | resource "aws_instance" "ec2" {
		41 |   ami                         = data.aws_ami.al2.id
		42 |   instance_type               = "t3.micro"
		43 |   subnet_id                   = aws_subnet.private.id
		44 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		45 |   associate_public_ip_address = false
		46 | 
		47 |   # Intentionally NO iam_instance_profile (SSM disabled)
		48 |   tags = local.common_tags
		49 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:40-49

		40 | resource "aws_instance" "ec2" {
		41 |   ami                         = data.aws_ami.al2.id
		42 |   instance_type               = "t3.micro"
		43 |   subnet_id                   = aws_subnet.private.id
		44 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		45 |   associate_public_ip_address = false
		46 | 
		47 |   # Intentionally NO iam_instance_profile (SSM disabled)
		48 |   tags = local.common_tags
		49 | }

Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:40-49

		40 | resource "aws_instance" "ec2" {
		41 |   ami                         = data.aws_ami.al2.id
		42 |   instance_type               = "t3.micro"
		43 |   subnet_id                   = aws_subnet.private.id
		44 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		45 |   associate_public_ip_address = false
		46 | 
		47 |   # Intentionally NO iam_instance_profile (SSM disabled)
		48 |   tags = local.common_tags
		49 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:12-17

		12 | resource "aws_vpc" "vpc" {
		13 |   cidr_block           = "10.60.0.0/16"
		14 |   enable_dns_support   = true
		15 |   enable_dns_hostnames = true
		16 |   tags                 = local.common_tags
		17 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:12-17

		12 | resource "aws_vpc" "vpc" {
		13 |   cidr_block           = "10.60.0.0/16"
		14 |   enable_dns_support   = true
		15 |   enable_dns_hostnames = true
		16 |   tags                 = local.common_tags
		17 | }

Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:40-49

		40 | resource "aws_instance" "ec2" {
		41 |   ami                         = data.aws_ami.al2.id
		42 |   instance_type               = "t3.micro"
		43 |   subnet_id                   = aws_subnet.private.id
		44 |   vpc_security_group_ids      = [aws_security_group.sg.id]
		45 |   associate_public_ip_address = false
		46 | 
		47 |   # Intentionally NO iam_instance_profile (SSM disabled)
		48 |   tags = local.common_tags
		49 | }

terraform_plan scan results:

Passed checks: 10, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.private
	File: /tfplan.json:0-0
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows egress to multiple public internet addresses.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:36
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   27  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   36  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m   ..  [0m
[0m[90m   38  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-egress-sgr
[0m[0m  [2m    Impact[0m Your port is egressing data to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mInstance does not require IMDS access to require a token[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:40-49
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   40  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   41  [0m[0m [0m[0m   [38;5;245mami[0m                         = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   42  [0m[0m [0m[0m   [38;5;245minstance_type[0m               = [38;5;37m"t3.micro"[0m
[0m[31m   43  [0m[0m [0m[0m [0m  [38;5;245msubnet_id[0m                   = aws_subnet.private.id[0m
[0m[31m   44  [0m[0m [0m[0m   [38;5;245mvpc_security_group_ids[0m      = [aws_security_group.sg.id][0m
[0m[31m   45  [0m[0m [0m[0m   [38;5;245massociate_public_ip_address[0m = [38;5;166mfalse[0m[0m
[0m[31m   46  [0m[0m [0m[0m [38;5;239m[0m
[0m[31m   47  [0m[0m [0m[0m   # Intentionally NO iam_instance_profile (SSM disabled)[0m
[0m[31m   48  [0m[0m [0m[0m [0m  [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   49  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enforce-http-token-imds
[0m[0m  [2m    Impact[0m Instance metadata service can be interacted with freely
[0m[0m  [2mResolution[0m Enable HTTP token requirement for IMDS
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mRoot block device is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:40-49
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   40  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   41  [0m[0m [0m[0m   [38;5;245mami[0m                         = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   42  [0m[0m [0m[0m   [38;5;245minstance_type[0m               = [38;5;37m"t3.micro"[0m
[0m[31m   43  [0m[0m [0m[0m [0m  [38;5;245msubnet_id[0m                   = aws_subnet.private.id[0m
[0m[31m   44  [0m[0m [0m[0m   [38;5;245mvpc_security_group_ids[0m      = [aws_security_group.sg.id][0m
[0m[31m   45  [0m[0m [0m[0m   [38;5;245massociate_public_ip_address[0m = [38;5;166mfalse[0m[0m
[0m[31m   46  [0m[0m [0m[0m [38;5;239m[0m
[0m[31m   47  [0m[0m [0m[0m   # Intentionally NO iam_instance_profile (SSM disabled)[0m
[0m[31m   48  [0m[0m [0m[0m [0m  [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   49  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m The block device could be compromised and read from
[0m[0m  [2mResolution[0m Turn on encryption for all block devices
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[33mMEDIUM[39m[0m [1mVPC Flow Logs is not enabled for VPC [0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:12-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   12  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_vpc"[0m [38;5;37m"vpc"[0m {[0m
[0m[31m   13  [0m[0m [0m[0m   [38;5;245mcidr_block[0m           = [38;5;37m"10.60.0.0/16"[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_dns_support[0m   = [38;5;166mtrue[0m
[0m[31m   15  [0m[0m [0m[0m [0m  [38;5;245menable_dns_hostnames[0m = [38;5;166mtrue[0m
[0m[31m   16  [0m[0m [0m[0m [0m  [38;5;245mtags[0m                 = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-require-vpc-flow-logs-for-all-vpcs
[0m[0m  [2m    Impact[0m Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
[0m[0m  [2mResolution[0m Enable flow logs for VPC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[97mLOW[39m[0m [1mSecurity group explicitly uses the default description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:27-38
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   27  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[31m   28  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   29  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[31m   30  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mtags[0m   = local.common_tags[0m
[0m[31m   31  [0m[0m[31mâ”‚[39m[0m[0m [0m
[0m[31m   32  [0m[0m[31mâ”‚[39m[0m[0m   egress {[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   34  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   35  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:32-37
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   27  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   28  [0m[0m    [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[90m   29  [0m[0m    [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[90m   30  [0m[0m    [38;5;245mtags[0m   = local.common_tags[0m
[0m[90m   31  [0m[0m  [0m
[0m[31m   32  [0m[0m[31mâ”Œ[39m[0m[0m   egress {[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   34  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   35  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 36.386Âµs
[0m[0m  [2mparsing             [0m 831.269Âµs
[0m[0m  [2madaptation          [0m 95.187Âµs
[0m[0m  [2mchecks              [0m 5.954983ms
[0m[0m  [2mtotal               [0m 6.917825ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 15
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 1
[0m[0m  [2mhigh                [0m 2
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 2
[0m
[0m  [31m[1m2 passed, 6 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)
[31mFAIL[0m - tfplan.json - main - Security Group aws_security_group.sg has unrestricted egress to 0.0.0.0/0 (review / high-risk)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:59:03 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-001-ssm-disabled-on-ec2/scan_logs/FULL_CMP-MISC-001-ssm-disabled-on-ec2.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-002-imdsv2-allowed
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-002-imdsv2-allowed

============================================================
FULL SCAN LOG START: 2025-12-22 02:59:03 UTC
Scenario: CMP-MISC-002-imdsv2-allowed
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-002-imdsv2-allowed
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====
[0m[1mdata.aws_ami.al2: Reading...[0m[0m
[0m[1mdata.aws_ami.al2: Read complete after 1s [id=ami-0ad8de99ac93341e7][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_instance.ec2[0m will be created
[0m  [32m+[0m[0m resource "aws_instance" "ec2" {
      [32m+[0m[0m ami                                  = "ami-0ad8de99ac93341e7"
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m associate_public_ip_address          = (known after apply)
      [32m+[0m[0m availability_zone                    = (known after apply)
      [32m+[0m[0m cpu_core_count                       = (known after apply)
      [32m+[0m[0m cpu_threads_per_core                 = (known after apply)
      [32m+[0m[0m disable_api_stop                     = (known after apply)
      [32m+[0m[0m disable_api_termination              = (known after apply)
      [32m+[0m[0m ebs_optimized                        = (known after apply)
      [32m+[0m[0m enable_primary_ipv6                  = (known after apply)
      [32m+[0m[0m get_password_data                    = false
      [32m+[0m[0m host_id                              = (known after apply)
      [32m+[0m[0m host_resource_group_arn              = (known after apply)
      [32m+[0m[0m iam_instance_profile                 = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_initiated_shutdown_behavior = (known after apply)
      [32m+[0m[0m instance_lifecycle                   = (known after apply)
      [32m+[0m[0m instance_state                       = (known after apply)
      [32m+[0m[0m instance_type                        = "t3.micro"
      [32m+[0m[0m ipv6_address_count                   = (known after apply)
      [32m+[0m[0m ipv6_addresses                       = (known after apply)
      [32m+[0m[0m key_name                             = (known after apply)
      [32m+[0m[0m monitoring                           = (known after apply)
      [32m+[0m[0m outpost_arn                          = (known after apply)
      [32m+[0m[0m password_data                        = (known after apply)
      [32m+[0m[0m placement_group                      = (known after apply)
      [32m+[0m[0m placement_partition_number           = (known after apply)
      [32m+[0m[0m primary_network_interface_id         = (known after apply)
      [32m+[0m[0m private_dns                          = (known after apply)
      [32m+[0m[0m private_ip                           = (known after apply)
      [32m+[0m[0m public_dns                           = (known after apply)
      [32m+[0m[0m public_ip                            = (known after apply)
      [32m+[0m[0m secondary_private_ips                = (known after apply)
      [32m+[0m[0m security_groups                      = (known after apply)
      [32m+[0m[0m source_dest_check                    = true
      [32m+[0m[0m spot_instance_request_id             = (known after apply)
      [32m+[0m[0m subnet_id                            = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "EC2.8"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-002-imdsv2-allowed"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "EC2.8"
          [32m+[0m[0m "domain"       = "CMP"
          [32m+[0m[0m "scenario_id"  = "CMP-MISC-002-imdsv2-allowed"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tenancy                              = (known after apply)
      [32m+[0m[0m user_data                            = (known after apply)
      [32m+[0m[0m user_data_base64                     = (known after apply)
      [32m+[0m[0m user_data_replace_on_change          = false
      [32m+[0m[0m vpc_security_group_ids               = (known after apply)

      [32m+[0m[0m capacity_reservation_specification (known after apply)

      [32m+[0m[0m cpu_options (known after apply)

      [32m+[0m[0m ebs_block_device (known after apply)

      [32m+[0m[0m enclave_options (known after apply)

      [32m+[0m[0m ephemeral_block_device (known after apply)

      [32m+[0m[0m instance_market_options (known after apply)

      [32m+[0m[0m maintenance_options (known after apply)

      [32m+[0m[0m metadata_options {
          [32m+[0m[0m http_endpoint               = "enabled"
          [32m+[0m[0m http_protocol_ipv6          = "disabled"
          [32m+[0m[0m http_put_response_hop_limit = (known after apply)
          [32m+[0m[0m http_tokens                 = "optional"
          [32m+[0m[0m instance_metadata_tags      = (known after apply)
        }

      [32m+[0m[0m network_interface (known after apply)

      [32m+[0m[0m private_dns_name_options (known after apply)

      [32m+[0m[0m root_block_device (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 4, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /main.tf:12-21
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /main.tf:12-21
Check: CKV_AWS_386: "Reduce potential for WhoAMI cloud image name confusion attack"
	PASSED for resource: aws_ami.al2
	File: /main.tf:3-10
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "optional"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "optional"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "optional"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "optional"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /main.tf:12-21

		12 | resource "aws_instance" "ec2" {
		13 |   ami           = data.aws_ami.al2.id
		14 |   instance_type = "t3.micro"
		15 | 
		16 |   metadata_options {
		17 |     http_tokens = "optional"
		18 |   }
		19 | 
		20 |   tags = local.common_tags
		21 | }

terraform_plan scan results:

Passed checks: 3, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_46: "Ensure no hard-coded secrets exist in EC2 user data"
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	PASSED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.ec2
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mRoot block device is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:12-21
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   12  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[31m   13  [0m[0m [0m[0m   [38;5;245mami[0m           = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[31m   14  [0m[0m [0m[0m   [38;5;245minstance_type[0m = [38;5;37m"t3.micro"[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   metadata_options {[0m
[0m[31m   17  [0m[0m [0m[0m     [38;5;245mhttp_tokens[0m = [38;5;37m"optional"[0m
[0m[31m   18  [0m[0m [0m[0m [0m  }[0m
[0m[31m   19  [0m[0m [0m[0m [0m
[0m[31m   20  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   21  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m The block device could be compromised and read from
[0m[0m  [2mResolution[0m Turn on encryption for all block devices
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mInstance does not require IMDS access to require a token[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   12  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_instance"[0m [38;5;37m"ec2"[0m {[0m
[0m[90m   13  [0m[0m    [38;5;245mami[0m           = [38;5;33mdata[0m.aws_ami.al2.id[0m
[0m[90m   14  [0m[0m    [38;5;245minstance_type[0m = [38;5;37m"t3.micro"[0m
[0m[90m   15  [0m[0m  [0m[0m
[0m[90m   16  [0m[0m    metadata_options {[0m
[0m[31m   17  [0m[0m[31m[[39m[0m[0m     [38;5;245mhttp_tokens[0m = [38;5;37m"optional"[0m[0m [3m[2m[3m("optional")[0m
[0m[90m   18  [0m[0m  [0m  }[0m
[0m[90m   19  [0m[0m  [0m
[0m[90m   20  [0m[0m    [38;5;245mtags[0m = local.common_tags[0m
[0m[90m   21  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-enforce-http-token-imds
[0m[0m  [2m    Impact[0m Instance metadata service can be interacted with freely
[0m[0m  [2mResolution[0m Enable HTTP token requirement for IMDS
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 35.162Âµs
[0m[0m  [2mparsing             [0m 472.594Âµs
[0m[0m  [2madaptation          [0m 78.053Âµs
[0m[0m  [2mchecks              [0m 4.98886ms
[0m[0m  [2mtotal               [0m 5.574669ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 2
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m1 passed, 2 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - EC2 aws_instance.ec2 does not enforce IMDSv2 (metadata_options.http_tokens must be 'required')
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:59:21 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/cmp/CMP-MISC-002-imdsv2-allowed/scan_logs/FULL_CMP-MISC-002-imdsv2-allowed.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-001-mfa-enforced
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-001-mfa-enforced

============================================================
FULL SCAN LOG START: 2025-12-22 02:59:21 UTC
Scenario: IAM-BENIGN-001-mfa-enforced
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-001-mfa-enforced
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_iam_policy.deny_without_mfa[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_policy" "deny_without_mfa" {
      [32m+[0m[0m arn              = (known after apply)
      [32m+[0m[0m attachment_count = (known after apply)
      [32m+[0m[0m id               = (known after apply)
      [32m+[0m[0m name             = (known after apply)
      [32m+[0m[0m name_prefix      = (known after apply)
      [32m+[0m[0m path             = "/"
      [32m+[0m[0m policy           = jsonencode(
            {
              [32m+[0m[0m Statement = [
                  [32m+[0m[0m {
                      [32m+[0m[0m Condition = {
                          [32m+[0m[0m BoolIfExists = {
                              [32m+[0m[0m "aws:MultiFactorAuthPresent" = "false"
                            }
                        }
                      [32m+[0m[0m Effect    = "Deny"
                      [32m+[0m[0m NotAction = [
                          [32m+[0m[0m "iam:CreateVirtualMFADevice",
                          [32m+[0m[0m "iam:EnableMFADevice",
                          [32m+[0m[0m "iam:GetUser",
                          [32m+[0m[0m "iam:ListMFADevices",
                          [32m+[0m[0m "iam:ListVirtualMFADevices",
                          [32m+[0m[0m "iam:ResyncMFADevice",
                        ]
                      [32m+[0m[0m Resource  = "*"
                      [32m+[0m[0m Sid       = "DenyAllUnlessMFA"
                    },
                ]
              [32m+[0m[0m Version   = "2012-10-17"
            }
        )
      [32m+[0m[0m policy_id        = (known after apply)
      [32m+[0m[0m tags_all         = {
          [32m+[0m[0m "cis_controls" = "IAM.6"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-BENIGN-001-mfa-enforced"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # aws_iam_user.user[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user" "user" {
      [32m+[0m[0m arn           = (known after apply)
      [32m+[0m[0m force_destroy = false
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m name          = (known after apply)
      [32m+[0m[0m path          = "/"
      [32m+[0m[0m tags          = {
          [32m+[0m[0m "cis_controls" = "IAM.6"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-BENIGN-001-mfa-enforced"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all      = {
          [32m+[0m[0m "cis_controls" = "IAM.6"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-BENIGN-001-mfa-enforced"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m unique_id     = (known after apply)
    }

[1m  # aws_iam_user_policy_attachment.attach[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user_policy_attachment" "attach" {
      [32m+[0m[0m id         = (known after apply)
      [32m+[0m[0m policy_arn = (known after apply)
      [32m+[0m[0m user       = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m4 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 12, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_user_policy_attachment.attach
	File: /main.tf:34-37
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /main.tf:3-6
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /main.tf:8-32
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /main.tf:3-6

		3 | resource "aws_iam_user" "user" {
		4 |   name = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.attach
	File: /main.tf:34-37

		34 | resource "aws_iam_user_policy_attachment" "attach" {
		35 |   user       = aws_iam_user.user.name
		36 |   policy_arn = aws_iam_policy.deny_without_mfa.arn
		37 | }

terraform_plan scan results:

Passed checks: 12, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_user_policy_attachment.attach
	File: /tfplan.json:0-0
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_policy.deny_without_mfa
	File: /tfplan.json:0-0
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.attach
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 59.26Âµs
[0m[0m  [2mparsing             [0m 1.417488ms
[0m[0m  [2madaptation          [0m 589.879Âµs
[0m[0m  [2mchecks              [0m 13.003707ms
[0m[0m  [2mtotal               [0m 15.070334ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 13
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:59:39 UTC
Return codes:
  checkov   = 1
  tfsec     = 0
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-001-mfa-enforced/scan_logs/FULL_IAM-BENIGN-001-mfa-enforced.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-002-no-admin-policy
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-002-no-admin-policy

============================================================
FULL SCAN LOG START: 2025-12-22 02:59:39 UTC
Scenario: IAM-BENIGN-002-no-admin-policy
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-002-no-admin-policy
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_iam_user.user[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user" "user" {
      [32m+[0m[0m arn           = (known after apply)
      [32m+[0m[0m force_destroy = false
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m name          = (known after apply)
      [32m+[0m[0m path          = "/"
      [32m+[0m[0m tags          = {
          [32m+[0m[0m "cis_controls" = "IAM.1"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-BENIGN-002-no-admin-policy"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all      = {
          [32m+[0m[0m "cis_controls" = "IAM.1"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-BENIGN-002-no-admin-policy"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m unique_id     = (known after apply)
    }

[1m  # aws_iam_user_policy_attachment.readonly[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user_policy_attachment" "readonly" {
      [32m+[0m[0m id         = (known after apply)
      [32m+[0m[0m policy_arn = "arn:aws:iam::aws:policy/ReadOnlyAccess"
      [32m+[0m[0m user       = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 4, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_user_policy_attachment.readonly
	File: /main.tf:8-11
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_user_policy_attachment.readonly
	File: /main.tf:8-11
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /main.tf:3-6
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /main.tf:3-6

		3 | resource "aws_iam_user" "user" {
		4 |   name = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.readonly
	File: /main.tf:8-11

		8  | resource "aws_iam_user_policy_attachment" "readonly" {
		9  |   user       = aws_iam_user.user.name
		10 |   policy_arn = "arn:aws:iam::aws:policy/ReadOnlyAccess"
		11 | }

terraform_plan scan results:

Passed checks: 4, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_user_policy_attachment.readonly
	File: /tfplan.json:0-0
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_user_policy_attachment.readonly
	File: /tfplan.json:0-0
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.readonly
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 48.886Âµs
[0m[0m  [2mparsing             [0m 1.242794ms
[0m[0m  [2madaptation          [0m 1.587301ms
[0m[0m  [2mchecks              [0m 6.247995ms
[0m[0m  [2mtotal               [0m 9.126976ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 02:59:55 UTC
Return codes:
  checkov   = 1
  tfsec     = 0
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-BENIGN-002-no-admin-policy/scan_logs/FULL_IAM-BENIGN-002-no-admin-policy.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-001-mfa-not-enforced
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-001-mfa-not-enforced

============================================================
FULL SCAN LOG START: 2025-12-22 02:59:55 UTC
Scenario: IAM-MISC-001-mfa-not-enforced
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-001-mfa-not-enforced
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_iam_user.user[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user" "user" {
      [32m+[0m[0m arn           = (known after apply)
      [32m+[0m[0m force_destroy = false
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m name          = (known after apply)
      [32m+[0m[0m path          = "/"
      [32m+[0m[0m tags          = {
          [32m+[0m[0m "cis_controls" = "IAM.6"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-MISC-001-mfa-not-enforced"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all      = {
          [32m+[0m[0m "cis_controls" = "IAM.6"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-MISC-001-mfa-not-enforced"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m unique_id     = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 2, Failed checks: 1, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /main.tf:3-6
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /main.tf:3-6

		3 | resource "aws_iam_user" "user" {
		4 |   name = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

terraform_plan scan results:

Passed checks: 2, Failed checks: 1, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 46.778Âµs
[0m[0m  [2mparsing             [0m 1.044074ms
[0m[0m  [2madaptation          [0m 184.272Âµs
[0m[0m  [2mchecks              [0m 13.309247ms
[0m[0m  [2mtotal               [0m 14.584371ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 11
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:00:14 UTC
Return codes:
  checkov   = 1
  tfsec     = 0
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-001-mfa-not-enforced/scan_logs/FULL_IAM-MISC-001-mfa-not-enforced.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-002-admin-policy-attached
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-002-admin-policy-attached

============================================================
FULL SCAN LOG START: 2025-12-22 03:00:14 UTC
Scenario: IAM-MISC-002-admin-policy-attached
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-002-admin-policy-attached
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_iam_user.user[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user" "user" {
      [32m+[0m[0m arn           = (known after apply)
      [32m+[0m[0m force_destroy = false
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m name          = (known after apply)
      [32m+[0m[0m path          = "/"
      [32m+[0m[0m tags          = {
          [32m+[0m[0m "cis_controls" = "IAM.1"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-MISC-002-admin-policy-attached"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all      = {
          [32m+[0m[0m "cis_controls" = "IAM.1"
          [32m+[0m[0m "domain"       = "IAM"
          [32m+[0m[0m "scenario_id"  = "IAM-MISC-002-admin-policy-attached"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m unique_id     = (known after apply)
    }

[1m  # aws_iam_user_policy_attachment.admin[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_user_policy_attachment" "admin" {
      [32m+[0m[0m id         = (known after apply)
      [32m+[0m[0m policy_arn = "arn:aws:iam::aws:policy/AdministratorAccess"
      [32m+[0m[0m user       = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 3, Failed checks: 3, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_user_policy_attachment.admin
	File: /main.tf:8-11
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /main.tf:3-6
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /main.tf:3-6

		3 | resource "aws_iam_user" "user" {
		4 |   name = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	FAILED for resource: aws_iam_user_policy_attachment.admin
	File: /main.tf:8-11

		8  | resource "aws_iam_user_policy_attachment" "admin" {
		9  |   user       = aws_iam_user.user.name
		10 |   policy_arn = "arn:aws:iam::aws:policy/AdministratorAccess"
		11 | }

Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.admin
	File: /main.tf:8-11

		8  | resource "aws_iam_user_policy_attachment" "admin" {
		9  |   user       = aws_iam_user.user.name
		10 |   policy_arn = "arn:aws:iam::aws:policy/AdministratorAccess"
		11 | }

terraform_plan scan results:

Passed checks: 3, Failed checks: 3, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_user_policy_attachment.admin
	File: /tfplan.json:0-0
Check: CKV2_AWS_22: "Ensure an IAM User does not have access to the console"
	PASSED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_273: "Ensure access is controlled through SSO and not AWS IAM defined users"
	FAILED for resource: aws_iam_user.user
	File: /tfplan.json:0-0
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	FAILED for resource: aws_iam_user_policy_attachment.admin
	File: /tfplan.json:0-0
Check: CKV_AWS_40: "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.)"
	FAILED for resource: aws_iam_user_policy_attachment.admin
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 56.472Âµs
[0m[0m  [2mparsing             [0m 910.973Âµs
[0m[0m  [2madaptation          [0m 136.402Âµs
[0m[0m  [2mchecks              [0m 9.182285ms
[0m[0m  [2mtotal               [0m 10.286132ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - IAM user policy attachment aws_iam_user_policy_attachment.admin uses AdministratorAccess (NOT allowed)
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:00:34 UTC
Return codes:
  checkov   = 1
  tfsec     = 0
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/iam/IAM-MISC-002-admin-policy-attached/scan_logs/FULL_IAM-MISC-002-admin-policy-attached.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-001-cloudtrail-enabled-all-regions
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-001-cloudtrail-enabled-all-regions

============================================================
FULL SCAN LOG START: 2025-12-22 03:00:34 UTC
Scenario: LOG-BENIGN-001-cloudtrail-enabled-all-regions
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-001-cloudtrail-enabled-all-regions
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_cloudtrail.trail[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudtrail" "trail" {
      [32m+[0m[0m arn                           = (known after apply)
      [32m+[0m[0m enable_log_file_validation    = false
      [32m+[0m[0m enable_logging                = true
      [32m+[0m[0m home_region                   = (known after apply)
      [32m+[0m[0m id                            = (known after apply)
      [32m+[0m[0m include_global_service_events = true
      [32m+[0m[0m is_multi_region_trail         = true
      [32m+[0m[0m is_organization_trail         = false
      [32m+[0m[0m name                          = (known after apply)
      [32m+[0m[0m s3_bucket_name                = (known after apply)
      [32m+[0m[0m sns_topic_arn                 = (known after apply)
      [32m+[0m[0m tags                          = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-001-cloudtrail-enabled-all-regions"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                      = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-001-cloudtrail-enabled-all-regions"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # aws_s3_bucket.trail_bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "trail_bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-001-cloudtrail-enabled-all-regions"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-001-cloudtrail-enabled-all-regions"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 7, Failed checks: 11, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_251: "Ensure CloudTrail logging is enabled"
	PASSED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17
Check: CKV_AWS_67: "Ensure CloudTrail is enabled in all Regions"
	PASSED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_35: "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = true
		13 |   include_global_service_events = true
		14 |   enable_logging                = true
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_36: "Ensure CloudTrail log file validation is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = true
		13 |   include_global_service_events = true
		14 |   enable_logging                = true
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_252: "Ensure CloudTrail defines an SNS Topic"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = true
		13 |   include_global_service_events = true
		14 |   enable_logging                = true
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_10: "Ensure CloudTrail trails are integrated with CloudWatch Logs"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = true
		13 |   include_global_service_events = true
		14 |   enable_logging                = true
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 7, Failed checks: 11, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_251: "Ensure CloudTrail logging is enabled"
	PASSED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_67: "Ensure CloudTrail is enabled in all Regions"
	PASSED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_35: "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_36: "Ensure CloudTrail log file validation is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_252: "Ensure CloudTrail defines an SNS Topic"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_10: "Ensure CloudTrail trails are integrated with CloudWatch Logs"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mTrail is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mtrue[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mtrue[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mtrue[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m Data can be freely read if compromised
[0m[0m  [2mResolution[0m Enable encryption at rest
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #8[0m [0m[31mHIGH[39m[0m [1mTrail does not have log validation enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mtrue[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mtrue[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mtrue[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-enable-log-validation
[0m[0m  [2m    Impact[0m Illicit activity could be removed from the logs
[0m[0m  [2mResolution[0m Turn on log validation for Cloudtrail
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/enable-log-validation/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #9[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #10[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #11[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #12[0m [0m[97mLOW[39m[0m [1mTrail does not have CloudWatch logging configured[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mtrue[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mtrue[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mtrue[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-ensure-cloudwatch-integration
[0m[0m  [2m    Impact[0m Realtime log analysis is not available without enabling CloudWatch logging
[0m[0m  [2mResolution[0m Enable logging to CloudWatch
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/ensure-cloudwatch-integration/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 50.131Âµs
[0m[0m  [2mparsing             [0m 991.893Âµs
[0m[0m  [2madaptation          [0m 141.562Âµs
[0m[0m  [2mchecks              [0m 9.281188ms
[0m[0m  [2mtotal               [0m 10.464774ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 8
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 2
[0m
[0m  [31m[1m2 passed, 12 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 20 passed, 0 warnings, 1 failure, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:00:54 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-001-cloudtrail-enabled-all-regions/scan_logs/FULL_LOG-BENIGN-001-cloudtrail-enabled-all-regions.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-002-cloudwatch-retention-set
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-002-cloudwatch-retention-set

============================================================
FULL SCAN LOG START: 2025-12-22 03:00:54 UTC
Scenario: LOG-BENIGN-002-cloudwatch-retention-set
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-002-cloudwatch-retention-set
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_cloudwatch_log_group.lg[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_group" "lg" {
      [32m+[0m[0m arn               = (known after apply)
      [32m+[0m[0m id                = (known after apply)
      [32m+[0m[0m log_group_class   = (known after apply)
      [32m+[0m[0m name              = (known after apply)
      [32m+[0m[0m name_prefix       = (known after apply)
      [32m+[0m[0m retention_in_days = 30
      [32m+[0m[0m skip_destroy      = false
      [32m+[0m[0m tags              = {
          [32m+[0m[0m "cis_controls" = "CW.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-002-cloudwatch-retention-set"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all          = {
          [32m+[0m[0m "cis_controls" = "CW.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-BENIGN-002-cloudwatch-retention-set"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 2, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	PASSED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-7
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-7

		3 | resource "aws_cloudwatch_log_group" "lg" {
		4 |   name              = lower(format("/app/%s-%s", var.scenario_id, local.name_suffix))
		5 |   retention_in_days = 30
		6 |   tags              = local.common_tags
		7 | }

Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-7

		3 | resource "aws_cloudwatch_log_group" "lg" {
		4 |   name              = lower(format("/app/%s-%s", var.scenario_id, local.name_suffix))
		5 |   retention_in_days = 30
		6 |   tags              = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 2, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	PASSED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0
Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[97mLOW[39m[0m [1mLog group is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudwatch_log_group"[0m [38;5;37m"lg"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mname[0m              = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"/app/%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mretention_in_days[0m = [38;5;37m30[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m              = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudwatch-log-group-customer-key
[0m[0m  [2m    Impact[0m Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.
[0m[0m  [2mResolution[0m Enable CMK encryption of CloudWatch Log Groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudwatch/log-group-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 47.188Âµs
[0m[0m  [2mparsing             [0m 709.474Âµs
[0m[0m  [2madaptation          [0m 129.776Âµs
[0m[0m  [2mchecks              [0m 8.796755ms
[0m[0m  [2mtotal               [0m 9.683193ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 11
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m1 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:01:14 UTC
Return codes:
  checkov   = 1
  tfsec     = 2
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-BENIGN-002-cloudwatch-retention-set/scan_logs/FULL_LOG-BENIGN-002-cloudwatch-retention-set.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-001-cloudtrail-disabled
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-001-cloudtrail-disabled

============================================================
FULL SCAN LOG START: 2025-12-22 03:01:14 UTC
Scenario: LOG-MISC-001-cloudtrail-disabled
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-001-cloudtrail-disabled
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_cloudtrail.trail[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudtrail" "trail" {
      [32m+[0m[0m arn                           = (known after apply)
      [32m+[0m[0m enable_log_file_validation    = false
      [32m+[0m[0m enable_logging                = false
      [32m+[0m[0m home_region                   = (known after apply)
      [32m+[0m[0m id                            = (known after apply)
      [32m+[0m[0m include_global_service_events = false
      [32m+[0m[0m is_multi_region_trail         = false
      [32m+[0m[0m is_organization_trail         = false
      [32m+[0m[0m name                          = (known after apply)
      [32m+[0m[0m s3_bucket_name                = (known after apply)
      [32m+[0m[0m sns_topic_arn                 = (known after apply)
      [32m+[0m[0m tags                          = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-001-cloudtrail-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                      = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-001-cloudtrail-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
    }

[1m  # aws_s3_bucket.trail_bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "trail_bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-001-cloudtrail-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "CT.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-001-cloudtrail-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 5, Failed checks: 13, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7
Check: CKV_AWS_251: "Ensure CloudTrail logging is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_35: "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_36: "Ensure CloudTrail log file validation is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_67: "Ensure CloudTrail is enabled in all Regions"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_252: "Ensure CloudTrail defines an SNS Topic"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_10: "Ensure CloudTrail trails are integrated with CloudWatch Logs"
	FAILED for resource: aws_cloudtrail.trail
	File: /main.tf:9-17

		9  | resource "aws_cloudtrail" "trail" {
		10 |   name                          = lower(format("%s-%s", var.scenario_id, local.name_suffix))
		11 |   s3_bucket_name                = aws_s3_bucket.trail_bucket.id
		12 |   is_multi_region_trail         = false
		13 |   include_global_service_events = false
		14 |   enable_logging                = false
		15 | 
		16 |   tags = local.common_tags
		17 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "trail_bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 5, Failed checks: 13, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_251: "Ensure CloudTrail logging is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_35: "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_36: "Ensure CloudTrail log file validation is enabled"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_67: "Ensure CloudTrail is enabled in all Regions"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_252: "Ensure CloudTrail defines an SNS Topic"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_10: "Ensure CloudTrail trails are integrated with CloudWatch Logs"
	FAILED for resource: aws_cloudtrail.trail
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.trail_bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mTrail is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mfalse[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mfalse[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mfalse[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-enable-at-rest-encryption
[0m[0m  [2m    Impact[0m Data can be freely read if compromised
[0m[0m  [2mResolution[0m Enable encryption at rest
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/enable-at-rest-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #8[0m [0m[31mHIGH[39m[0m [1mTrail does not have log validation enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mfalse[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mfalse[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mfalse[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-enable-log-validation
[0m[0m  [2m    Impact[0m Illicit activity could be removed from the logs
[0m[0m  [2mResolution[0m Turn on log validation for Cloudtrail
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/enable-log-validation/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #9[0m [0m[33mMEDIUM[39m[0m [1mTrail is not enabled across all regions.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:12
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m    9  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[90m   10  [0m[0m    [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[90m   11  [0m[0m    [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m[31m[[39m[0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   13  [0m[0m  [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mfalse[0m
[0m[90m   14  [0m[0m  [0m  [38;5;245menable_logging[0m                = [38;5;166mfalse[0m
[0m[90m   15  [0m[0m  [0m[0m
[0m[90m   16  [0m[0m    [38;5;245mtags[0m = local.common_tags[0m
[0m[90m   17  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-enable-all-regions
[0m[0m  [2m    Impact[0m Activity could be happening in your account in a different region
[0m[0m  [2mResolution[0m Enable Cloudtrail in all regions
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/enable-all-regions/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #10[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #11[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #12[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"trail_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #13[0m [0m[97mLOW[39m[0m [1mTrail does not have CloudWatch logging configured[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:9-17
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    9  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudtrail"[0m [38;5;37m"trail"[0m {[0m
[0m[31m   10  [0m[0m [0m[0m   [38;5;245mname[0m                          = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245ms3_bucket_name[0m                = aws_s3_bucket.trail_bucket.id[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mis_multi_region_trail[0m         = [38;5;166mfalse[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245minclude_global_service_events[0m = [38;5;166mfalse[0m
[0m[31m   14  [0m[0m [0m[0m [0m  [38;5;245menable_logging[0m                = [38;5;166mfalse[0m
[0m[31m   15  [0m[0m [0m[0m [0m[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   17  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudtrail-ensure-cloudwatch-integration
[0m[0m  [2m    Impact[0m Realtime log analysis is not available without enabling CloudWatch logging
[0m[0m  [2mResolution[0m Enable logging to CloudWatch
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudtrail/ensure-cloudwatch-integration/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 49.815Âµs
[0m[0m  [2mparsing             [0m 1.557047ms
[0m[0m  [2madaptation          [0m 152.286Âµs
[0m[0m  [2mchecks              [0m 12.183208ms
[0m[0m  [2mtotal               [0m 13.942356ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 8
[0m[0m  [2mmedium              [0m 3
[0m[0m  [2mlow                 [0m 2
[0m
[0m  [31m[1m1 passed, 13 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - CloudTrail aws_cloudtrail.trail has enable_logging=false (NOT allowed)
[31mFAIL[0m - tfplan.json - main - CloudTrail aws_cloudtrail.trail is not multi-region (recommended TRUE)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:01:34 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-001-cloudtrail-disabled/scan_logs/FULL_LOG-MISC-001-cloudtrail-disabled.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-002-cloudwatch-retention-not-set
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-002-cloudwatch-retention-not-set

============================================================
FULL SCAN LOG START: 2025-12-22 03:01:34 UTC
Scenario: LOG-MISC-002-cloudwatch-retention-not-set
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-002-cloudwatch-retention-not-set
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_cloudwatch_log_group.lg[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_group" "lg" {
      [32m+[0m[0m arn               = (known after apply)
      [32m+[0m[0m id                = (known after apply)
      [32m+[0m[0m log_group_class   = (known after apply)
      [32m+[0m[0m name              = (known after apply)
      [32m+[0m[0m name_prefix       = (known after apply)
      [32m+[0m[0m retention_in_days = 0
      [32m+[0m[0m skip_destroy      = false
      [32m+[0m[0m tags              = {
          [32m+[0m[0m "cis_controls" = "CW.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-002-cloudwatch-retention-not-set"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all          = {
          [32m+[0m[0m "cis_controls" = "CW.1"
          [32m+[0m[0m "domain"       = "LOG"
          [32m+[0m[0m "scenario_id"  = "LOG-MISC-002-cloudwatch-retention-not-set"
          [32m+[0m[0m "type"         = "MISC"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 1, Failed checks: 3, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-6

		3 | resource "aws_cloudwatch_log_group" "lg" {
		4 |   name = lower(format("/app/%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-6

		3 | resource "aws_cloudwatch_log_group" "lg" {
		4 |   name = lower(format("/app/%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /main.tf:3-6

		3 | resource "aws_cloudwatch_log_group" "lg" {
		4 |   name = lower(format("/app/%s-%s", var.scenario_id, local.name_suffix))
		5 |   tags = local.common_tags
		6 | }

terraform_plan scan results:

Passed checks: 3, Failed checks: 1, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	PASSED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0
Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	PASSED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.lg
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[97mLOW[39m[0m [1mLog group is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-6
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudwatch_log_group"[0m [38;5;37m"lg"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mname[0m = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"/app/%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m    6  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudwatch-log-group-customer-key
[0m[0m  [2m    Impact[0m Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.
[0m[0m  [2mResolution[0m Enable CMK encryption of CloudWatch Log Groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudwatch/log-group-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 47.805Âµs
[0m[0m  [2mparsing             [0m 1.020383ms
[0m[0m  [2madaptation          [0m 139.212Âµs
[0m[0m  [2mchecks              [0m 13.855138ms
[0m[0m  [2mtotal               [0m 15.062538ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 11
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m1 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:01:54 UTC
Return codes:
  checkov   = 1
  tfsec     = 2
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/log/LOG-MISC-002-cloudwatch-retention-not-set/scan_logs/FULL_LOG-MISC-002-cloudwatch-retention-not-set.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-001-no-ssh-open
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-001-no-ssh-open

============================================================
FULL SCAN LOG START: 2025-12-22 03:01:54 UTC
Scenario: NET-BENIGN-001-no-ssh-open
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-001-no-ssh-open
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_security_group.sg[0m will be created
[0m  [32m+[0m[0m resource "aws_security_group" "sg" {
      [32m+[0m[0m arn                    = (known after apply)
      [32m+[0m[0m description            = "Managed by Terraform"
      [32m+[0m[0m egress                 = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "0.0.0.0/0",
                ]
              [32m+[0m[0m from_port        = 0
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "-1"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 0
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m id                     = (known after apply)
      [32m+[0m[0m ingress                = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "10.51.0.0/16",
                ]
              [32m+[0m[0m from_port        = 22
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "tcp"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 22
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m name                   = (known after apply)
      [32m+[0m[0m name_prefix            = (known after apply)
      [32m+[0m[0m owner_id               = (known after apply)
      [32m+[0m[0m revoke_rules_on_delete = false
      [32m+[0m[0m tags                   = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all               = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m vpc_id                 = (known after apply)
    }

[1m  # aws_subnet.subnet[0m will be created
[0m  [32m+[0m[0m resource "aws_subnet" "subnet" {
      [32m+[0m[0m arn                                            = (known after apply)
      [32m+[0m[0m assign_ipv6_address_on_creation                = false
      [32m+[0m[0m availability_zone                              = "eu-west-2a"
      [32m+[0m[0m availability_zone_id                           = (known after apply)
      [32m+[0m[0m cidr_block                                     = "10.51.1.0/24"
      [32m+[0m[0m enable_dns64                                   = false
      [32m+[0m[0m enable_resource_name_dns_a_record_on_launch    = false
      [32m+[0m[0m enable_resource_name_dns_aaaa_record_on_launch = false
      [32m+[0m[0m id                                             = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_association_id                 = (known after apply)
      [32m+[0m[0m ipv6_native                                    = false
      [32m+[0m[0m map_public_ip_on_launch                        = false
      [32m+[0m[0m owner_id                                       = (known after apply)
      [32m+[0m[0m private_dns_hostname_type_on_launch            = (known after apply)
      [32m+[0m[0m tags                                           = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                                       = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m vpc_id                                         = (known after apply)
    }

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.51.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-001-no-ssh-open"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m4 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 6, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet
	File: /main.tf:10-15
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["10.51.0.0/16"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["10.51.0.0/16"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.51.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["10.51.0.0/16"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.51.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

terraform_plan scan results:

Passed checks: 7, Failed checks: 4, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet
	File: /tfplan.json:0-0
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows egress to multiple public internet addresses.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:33
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   33  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m   ..  [0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-egress-sgr
[0m[0m  [2m    Impact[0m Your port is egressing data to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mVPC Flow Logs is not enabled for VPC [0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-8
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_vpc"[0m [38;5;37m"vpc"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mcidr_block[0m           = [38;5;37m"10.51.0.0/16"[0m
[0m[31m    5  [0m[0m [0m[0m [0m  [38;5;245menable_dns_support[0m   = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245menable_dns_hostnames[0m = [38;5;166mtrue[0m
[0m[31m    7  [0m[0m [0m[0m [0m  [38;5;245mtags[0m                 = local.common_tags[0m
[0m[31m    8  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-require-vpc-flow-logs-for-all-vpcs
[0m[0m  [2m    Impact[0m Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
[0m[0m  [2mResolution[0m Enable flow logs for VPC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[97mLOW[39m[0m [1mSecurity group explicitly uses the default description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:17-35
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   17  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[31m   18  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   19  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[31m   20  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mtags[0m   = local.common_tags[0m
[0m[31m   21  [0m[0m[31mâ”‚[39m[0m[0m [0m
[0m[31m   22  [0m[0m[31mâ”‚[39m[0m[0m   ingress {[0m
[0m[31m   23  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m22[0m
[0m[31m   24  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m22[0m
[0m[31m   25  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"tcp"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:22-27
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   22  [0m[0m[31mâ”Œ[39m[0m[0m   ingress {[0m
[0m[31m   23  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m22[0m
[0m[31m   24  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m22[0m
[0m[31m   25  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"tcp"[0m
[0m[31m   26  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"10.51.0.0/16"[0m][0m
[0m[31m   27  [0m[0m[31mâ””[39m[0m[0m   }[0m
[0m[90m   ..  [0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:29-34
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   29  [0m[0m[31mâ”Œ[39m[0m[0m   egress {[0m
[0m[31m   30  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   31  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   32  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[31m   34  [0m[0m[31mâ””[39m[0m[0m   }[0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 63.422Âµs
[0m[0m  [2mparsing             [0m 1.737013ms
[0m[0m  [2madaptation          [0m 173.054Âµs
[0m[0m  [2mchecks              [0m 17.947344ms
[0m[0m  [2mtotal               [0m 19.920833ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 13
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 1
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 3
[0m
[0m  [31m[1m2 passed, 5 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)
[31mFAIL[0m - tfplan.json - main - Security Group aws_security_group.sg has unrestricted egress to 0.0.0.0/0 (review / high-risk)

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:02:15 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-001-no-ssh-open/scan_logs/FULL_NET-BENIGN-001-no-ssh-open.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-002-vpc-flow-logs-enabled
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-002-vpc-flow-logs-enabled

============================================================
FULL SCAN LOG START: 2025-12-22 03:02:15 UTC
Scenario: NET-BENIGN-002-vpc-flow-logs-enabled
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-002-vpc-flow-logs-enabled
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_cloudwatch_log_group.flowlogs[0m will be created
[0m  [32m+[0m[0m resource "aws_cloudwatch_log_group" "flowlogs" {
      [32m+[0m[0m arn               = (known after apply)
      [32m+[0m[0m id                = (known after apply)
      [32m+[0m[0m log_group_class   = (known after apply)
      [32m+[0m[0m name              = (known after apply)
      [32m+[0m[0m name_prefix       = (known after apply)
      [32m+[0m[0m retention_in_days = 30
      [32m+[0m[0m skip_destroy      = false
      [32m+[0m[0m tags              = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all          = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # aws_flow_log.vpc_flow[0m will be created
[0m  [32m+[0m[0m resource "aws_flow_log" "vpc_flow" {
      [32m+[0m[0m arn                      = (known after apply)
      [32m+[0m[0m iam_role_arn             = (known after apply)
      [32m+[0m[0m id                       = (known after apply)
      [32m+[0m[0m log_destination          = (known after apply)
      [32m+[0m[0m log_destination_type     = "cloud-watch-logs"
      [32m+[0m[0m log_format               = (known after apply)
      [32m+[0m[0m log_group_name           = (known after apply)
      [32m+[0m[0m max_aggregation_interval = 600
      [32m+[0m[0m tags                     = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                 = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m traffic_type             = "ALL"
      [32m+[0m[0m vpc_id                   = (known after apply)
    }

[1m  # aws_iam_role.flowlogs_role[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_role" "flowlogs_role" {
      [32m+[0m[0m arn                   = (known after apply)
      [32m+[0m[0m assume_role_policy    = jsonencode(
            {
              [32m+[0m[0m Statement = [
                  [32m+[0m[0m {
                      [32m+[0m[0m Action    = "sts:AssumeRole"
                      [32m+[0m[0m Effect    = "Allow"
                      [32m+[0m[0m Principal = {
                          [32m+[0m[0m Service = "vpc-flow-logs.amazonaws.com"
                        }
                    },
                ]
              [32m+[0m[0m Version   = "2012-10-17"
            }
        )
      [32m+[0m[0m create_date           = (known after apply)
      [32m+[0m[0m force_detach_policies = false
      [32m+[0m[0m id                    = (known after apply)
      [32m+[0m[0m managed_policy_arns   = (known after apply)
      [32m+[0m[0m max_session_duration  = 3600
      [32m+[0m[0m name                  = (known after apply)
      [32m+[0m[0m name_prefix           = (known after apply)
      [32m+[0m[0m path                  = "/"
      [32m+[0m[0m tags                  = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all              = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m unique_id             = (known after apply)

      [32m+[0m[0m inline_policy (known after apply)
    }

[1m  # aws_iam_role_policy.flowlogs_policy[0m will be created
[0m  [32m+[0m[0m resource "aws_iam_role_policy" "flowlogs_policy" {
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m name        = (known after apply)
      [32m+[0m[0m name_prefix = (known after apply)
      [32m+[0m[0m policy      = jsonencode(
            {
              [32m+[0m[0m Statement = [
                  [32m+[0m[0m {
                      [32m+[0m[0m Action   = [
                          [32m+[0m[0m "logs:CreateLogStream",
                          [32m+[0m[0m "logs:PutLogEvents",
                          [32m+[0m[0m "logs:DescribeLogGroups",
                          [32m+[0m[0m "logs:DescribeLogStreams",
                        ]
                      [32m+[0m[0m Effect   = "Allow"
                      [32m+[0m[0m Resource = "*"
                    },
                ]
              [32m+[0m[0m Version   = "2012-10-17"
            }
        )
      [32m+[0m[0m role        = (known after apply)
    }

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.53.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-BENIGN-002-vpc-flow-logs-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m6 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 13, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	PASSED for resource: aws_cloudwatch_log_group.flowlogs
	File: /main.tf:10-14
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /main.tf:16-29
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /main.tf:16-29
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /main.tf:16-29
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	PASSED for resource: aws_vpc.vpc
	File: /main.tf:3-8
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.flowlogs
	File: /main.tf:10-14

		10 | resource "aws_cloudwatch_log_group" "flowlogs" {
		11 |   name              = lower(format("/vpc/flowlogs/%s-%s", var.scenario_id, local.name_suffix))
		12 |   retention_in_days = 30
		13 |   tags              = local.common_tags
		14 | }

Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	FAILED for resource: aws_cloudwatch_log_group.flowlogs
	File: /main.tf:10-14

		10 | resource "aws_cloudwatch_log_group" "flowlogs" {
		11 |   name              = lower(format("/vpc/flowlogs/%s-%s", var.scenario_id, local.name_suffix))
		12 |   retention_in_days = 30
		13 |   tags              = local.common_tags
		14 | }

Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	FAILED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48

		31 | resource "aws_iam_role_policy" "flowlogs_policy" {
		32 |   name = lower(format("%s-flowlogs-policy-%s", var.scenario_id, local.name_suffix))
		33 |   role = aws_iam_role.flowlogs_role.id
		34 | 
		35 |   policy = jsonencode({
		36 |     Version = "2012-10-17",
		37 |     Statement = [{
		38 |       Effect = "Allow",
		39 |       Action = [
		40 |         "logs:CreateLogStream",
		41 |         "logs:PutLogEvents",
		42 |         "logs:DescribeLogGroups",
		43 |         "logs:DescribeLogStreams"
		44 |       ],
		45 |       Resource = "*"
		46 |     }]
		47 |   })
		48 | }

Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: aws_iam_role_policy.flowlogs_policy
	File: /main.tf:31-48

		31 | resource "aws_iam_role_policy" "flowlogs_policy" {
		32 |   name = lower(format("%s-flowlogs-policy-%s", var.scenario_id, local.name_suffix))
		33 |   role = aws_iam_role.flowlogs_role.id
		34 | 
		35 |   policy = jsonencode({
		36 |     Version = "2012-10-17",
		37 |     Statement = [{
		38 |       Effect = "Allow",
		39 |       Action = [
		40 |         "logs:CreateLogStream",
		41 |         "logs:PutLogEvents",
		42 |         "logs:DescribeLogGroups",
		43 |         "logs:DescribeLogStreams"
		44 |       ],
		45 |       Resource = "*"
		46 |     }]
		47 |   })
		48 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.53.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

terraform_plan scan results:

Passed checks: 14, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_66: "Ensure that CloudWatch Log Group specifies retention days"
	PASSED for resource: aws_cloudwatch_log_group.flowlogs
	File: /tfplan.json:0-0
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /tfplan.json:0-0
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /tfplan.json:0-0
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /tfplan.json:0-0
Check: CKV_AWS_62: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_287: "Ensure IAM policies does not allow credentials exposure"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_286: "Ensure IAM policies does not allow privilege escalation"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_63: "Ensure no IAM policies documents allow "*" as a statement's actions"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_289: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_288: "Ensure IAM policies does not allow data exfiltration"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	PASSED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_56: "Ensure AWS Managed IAMFullAccess IAM policy is not used."
	PASSED for resource: aws_iam_role.flowlogs_role
	File: /tfplan.json:0-0
Check: CKV2_AWS_40: "Ensure AWS IAM policy does not allow full IAM privileges"
	PASSED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_158: "Ensure that CloudWatch Log Group is encrypted by KMS"
	FAILED for resource: aws_cloudwatch_log_group.flowlogs
	File: /tfplan.json:0-0
Check: CKV_AWS_338: "Ensure CloudWatch log groups retains logs for at least 1 year"
	FAILED for resource: aws_cloudwatch_log_group.flowlogs
	File: /tfplan.json:0-0
Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	FAILED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: aws_iam_role_policy.flowlogs_policy
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'logs:CreateLogStream' on wildcarded resource '*'[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:36
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   31  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_iam_role_policy"[0m [38;5;37m"flowlogs_policy"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   36  [0m[0m[31m[[39m[0m[0m     [38;5;245mVersion[0m = [38;5;37m"2012-10-17"[0m,[0m
[0m[90m   ..  [0m
[0m[90m   48  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[97mLOW[39m[0m [1mLog group is not encrypted.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:10-14
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   10  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_cloudwatch_log_group"[0m [38;5;37m"flowlogs"[0m {[0m
[0m[31m   11  [0m[0m [0m[0m   [38;5;245mname[0m              = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"/vpc/flowlogs/%s-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   12  [0m[0m [0m[0m   [38;5;245mretention_in_days[0m = [38;5;37m30[0m
[0m[31m   13  [0m[0m [0m[0m [0m  [38;5;245mtags[0m              = local.common_tags[0m
[0m[31m   14  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-cloudwatch-log-group-customer-key
[0m[0m  [2m    Impact[0m Log data may be leaked if the logs are compromised. No auditing of who have viewed the logs.
[0m[0m  [2mResolution[0m Enable CMK encryption of CloudWatch Log Groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudwatch/log-group-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 66.297Âµs
[0m[0m  [2mparsing             [0m 2.574262ms
[0m[0m  [2madaptation          [0m 696.686Âµs
[0m[0m  [2mchecks              [0m 31.982377ms
[0m[0m  [2mtotal               [0m 35.319622ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 15
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 5
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m5 passed, 2 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)

[31m21 tests, 20 passed, 0 warnings, 1 failure, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:02:35 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-BENIGN-002-vpc-flow-logs-enabled/scan_logs/FULL_NET-BENIGN-002-vpc-flow-logs-enabled.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-001-ssh-open-to-world
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-001-ssh-open-to-world

============================================================
FULL SCAN LOG START: 2025-12-22 03:02:35 UTC
Scenario: NET-MISC-001-ssh-open-to-world
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-001-ssh-open-to-world
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_security_group.sg[0m will be created
[0m  [32m+[0m[0m resource "aws_security_group" "sg" {
      [32m+[0m[0m arn                    = (known after apply)
      [32m+[0m[0m description            = "Managed by Terraform"
      [32m+[0m[0m egress                 = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "0.0.0.0/0",
                ]
              [32m+[0m[0m from_port        = 0
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "-1"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 0
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m id                     = (known after apply)
      [32m+[0m[0m ingress                = [
          [32m+[0m[0m {
              [32m+[0m[0m cidr_blocks      = [
                  [32m+[0m[0m "0.0.0.0/0",
                ]
              [32m+[0m[0m from_port        = 22
              [32m+[0m[0m ipv6_cidr_blocks = []
              [32m+[0m[0m prefix_list_ids  = []
              [32m+[0m[0m protocol         = "tcp"
              [32m+[0m[0m security_groups  = []
              [32m+[0m[0m self             = false
              [32m+[0m[0m to_port          = 22
                [90m# (1 unchanged attribute hidden)[0m[0m
            },
        ]
      [32m+[0m[0m name                   = (known after apply)
      [32m+[0m[0m name_prefix            = (known after apply)
      [32m+[0m[0m owner_id               = (known after apply)
      [32m+[0m[0m revoke_rules_on_delete = false
      [32m+[0m[0m tags                   = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all               = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m vpc_id                 = (known after apply)
    }

[1m  # aws_subnet.subnet[0m will be created
[0m  [32m+[0m[0m resource "aws_subnet" "subnet" {
      [32m+[0m[0m arn                                            = (known after apply)
      [32m+[0m[0m assign_ipv6_address_on_creation                = false
      [32m+[0m[0m availability_zone                              = "eu-west-2a"
      [32m+[0m[0m availability_zone_id                           = (known after apply)
      [32m+[0m[0m cidr_block                                     = "10.50.1.0/24"
      [32m+[0m[0m enable_dns64                                   = false
      [32m+[0m[0m enable_resource_name_dns_a_record_on_launch    = false
      [32m+[0m[0m enable_resource_name_dns_aaaa_record_on_launch = false
      [32m+[0m[0m id                                             = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_association_id                 = (known after apply)
      [32m+[0m[0m ipv6_native                                    = false
      [32m+[0m[0m map_public_ip_on_launch                        = false
      [32m+[0m[0m owner_id                                       = (known after apply)
      [32m+[0m[0m private_dns_hostname_type_on_launch            = (known after apply)
      [32m+[0m[0m tags                                           = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                                       = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m vpc_id                                         = (known after apply)
    }

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.50.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "EC2.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-001-ssh-open-to-world"
          [32m+[0m[0m "type"         = "MISC"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m4 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 5, Failed checks: 6, Skipped checks: 0

Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet
	File: /main.tf:10-15
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /main.tf:17-35
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["0.0.0.0/0"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["0.0.0.0/0"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["0.0.0.0/0"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.50.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	FAILED for resource: aws_security_group.sg
	File: /main.tf:17-35

		17 | resource "aws_security_group" "sg" {
		18 |   name   = lower(format("%s-sg-%s", var.scenario_id, local.name_suffix))
		19 |   vpc_id = aws_vpc.vpc.id
		20 |   tags   = local.common_tags
		21 | 
		22 |   ingress {
		23 |     from_port   = 22
		24 |     to_port     = 22
		25 |     protocol    = "tcp"
		26 |     cidr_blocks = ["0.0.0.0/0"]
		27 |   }
		28 | 
		29 |   egress {
		30 |     from_port   = 0
		31 |     to_port     = 0
		32 |     protocol    = "-1"
		33 |     cidr_blocks = ["0.0.0.0/0"]
		34 |   }
		35 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.50.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

terraform_plan scan results:

Passed checks: 6, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_277: "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_25: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389"
	PASSED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	PASSED for resource: aws_subnet.subnet
	File: /tfplan.json:0-0
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	FAILED for resource: aws_security_group.sg
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows ingress from public internet.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   26  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m   ..  [0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-ingress-sgr
[0m[0m  [2m    Impact[0m Your port exposed to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[1m[31mCRITICAL[39m[0m[39m[0m [1mSecurity group rule allows egress to multiple public internet addresses.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:33
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   33  [0m[0m[31m[[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[90m   ..  [0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-no-public-egress-sgr
[0m[0m  [2m    Impact[0m Your port is egressing data to the internet
[0m[0m  [2mResolution[0m Set a more restrictive cidr range
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[33mMEDIUM[39m[0m [1mVPC Flow Logs is not enabled for VPC [0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-8
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_vpc"[0m [38;5;37m"vpc"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mcidr_block[0m           = [38;5;37m"10.50.0.0/16"[0m
[0m[31m    5  [0m[0m [0m[0m [0m  [38;5;245menable_dns_support[0m   = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245menable_dns_hostnames[0m = [38;5;166mtrue[0m
[0m[31m    7  [0m[0m [0m[0m [0m  [38;5;245mtags[0m                 = local.common_tags[0m
[0m[31m    8  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-require-vpc-flow-logs-for-all-vpcs
[0m[0m  [2m    Impact[0m Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
[0m[0m  [2mResolution[0m Enable flow logs for VPC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[97mLOW[39m[0m [1mSecurity group explicitly uses the default description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:17-35
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   17  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[31m   18  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mname[0m   = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-sg-%s"[0m, [38;5;33mvar[0m.scenario_id, local.name_suffix))[0m
[0m[31m   19  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mvpc_id[0m = aws_vpc.vpc.id[0m
[0m[31m   20  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mtags[0m   = local.common_tags[0m
[0m[31m   21  [0m[0m[31mâ”‚[39m[0m[0m [0m
[0m[31m   22  [0m[0m[31mâ”‚[39m[0m[0m   ingress {[0m
[0m[31m   23  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m22[0m
[0m[31m   24  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m22[0m
[0m[31m   25  [0m[0m[31mâ””[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"tcp"[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:22-27
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   22  [0m[0m[31mâ”Œ[39m[0m[0m   ingress {[0m
[0m[31m   23  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m22[0m
[0m[31m   24  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m22[0m
[0m[31m   25  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"tcp"[0m
[0m[31m   26  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[31m   27  [0m[0m[31mâ””[39m[0m[0m   }[0m
[0m[90m   ..  [0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[97mLOW[39m[0m [1mSecurity group rule does not have a description.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:29-34
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   17  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_security_group"[0m [38;5;37m"sg"[0m {[0m
[0m[90m   ..  [0m
[0m[31m   29  [0m[0m[31mâ”Œ[39m[0m[0m   egress {[0m
[0m[31m   30  [0m[0m[31mâ”‚[39m[0m[0m     [38;5;245mfrom_port[0m   = [38;5;37m0[0m
[0m[31m   31  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mto_port[0m     = [38;5;37m0[0m
[0m[31m   32  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mprotocol[0m    = [38;5;37m"-1"[0m
[0m[31m   33  [0m[0m[31mâ”‚[39m[0m[0m [0m    [38;5;245mcidr_blocks[0m = [[38;5;37m"0.0.0.0/0"[0m][0m
[0m[31m   34  [0m[0m[31mâ””[39m[0m[0m   }[0m
[0m[90m   35  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-add-description-to-security-group-rule
[0m[0m  [2m    Impact[0m Descriptions provide context for the firewall rule reasons
[0m[0m  [2mResolution[0m Add descriptions for all security groups rules
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 65.987Âµs
[0m[0m  [2mparsing             [0m 1.48836ms
[0m[0m  [2madaptation          [0m 201.304Âµs
[0m[0m  [2mchecks              [0m 31.714419ms
[0m[0m  [2mtotal               [0m 33.47007ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 13
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 2
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 3
[0m
[0m  [31m[1m1 passed, 6 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)
[31mFAIL[0m - tfplan.json - main - Security Group aws_security_group.sg allows SSH (22) from 0.0.0.0/0 (NOT allowed)
[31mFAIL[0m - tfplan.json - main - Security Group aws_security_group.sg has unrestricted egress to 0.0.0.0/0 (review / high-risk)

[31m21 tests, 17 passed, 0 warnings, 4 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:02:56 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-001-ssh-open-to-world/scan_logs/FULL_NET-MISC-001-ssh-open-to-world.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-002-vpc-flow-logs-disabled
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-002-vpc-flow-logs-disabled

============================================================
FULL SCAN LOG START: 2025-12-22 03:02:56 UTC
Scenario: NET-MISC-002-vpc-flow-logs-disabled
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-002-vpc-flow-logs-disabled
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_vpc.vpc[0m will be created
[0m  [32m+[0m[0m resource "aws_vpc" "vpc" {
      [32m+[0m[0m arn                                  = (known after apply)
      [32m+[0m[0m cidr_block                           = "10.52.0.0/16"
      [32m+[0m[0m default_network_acl_id               = (known after apply)
      [32m+[0m[0m default_route_table_id               = (known after apply)
      [32m+[0m[0m default_security_group_id            = (known after apply)
      [32m+[0m[0m dhcp_options_id                      = (known after apply)
      [32m+[0m[0m enable_dns_hostnames                 = true
      [32m+[0m[0m enable_dns_support                   = true
      [32m+[0m[0m enable_network_address_usage_metrics = (known after apply)
      [32m+[0m[0m id                                   = (known after apply)
      [32m+[0m[0m instance_tenancy                     = "default"
      [32m+[0m[0m ipv6_association_id                  = (known after apply)
      [32m+[0m[0m ipv6_cidr_block                      = (known after apply)
      [32m+[0m[0m ipv6_cidr_block_network_border_group = (known after apply)
      [32m+[0m[0m main_route_table_id                  = (known after apply)
      [32m+[0m[0m owner_id                             = (known after apply)
      [32m+[0m[0m tags                                 = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-002-vpc-flow-logs-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                             = {
          [32m+[0m[0m "cis_controls" = "VPC.2"
          [32m+[0m[0m "domain"       = "NET"
          [32m+[0m[0m "scenario_id"  = "NET-MISC-002-vpc-flow-logs-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m2 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 1, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.52.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /main.tf:3-8

		3 | resource "aws_vpc" "vpc" {
		4 |   cidr_block           = "10.52.0.0/16"
		5 |   enable_dns_support   = true
		6 |   enable_dns_hostnames = true
		7 |   tags                 = local.common_tags
		8 | }

terraform_plan scan results:

Passed checks: 1, Failed checks: 2, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.vpc
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[33mMEDIUM[39m[0m [1mVPC Flow Logs is not enabled for VPC [0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-8
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_vpc"[0m [38;5;37m"vpc"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mcidr_block[0m           = [38;5;37m"10.52.0.0/16"[0m
[0m[31m    5  [0m[0m [0m[0m [0m  [38;5;245menable_dns_support[0m   = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245menable_dns_hostnames[0m = [38;5;166mtrue[0m
[0m[31m    7  [0m[0m [0m[0m [0m  [38;5;245mtags[0m                 = local.common_tags[0m
[0m[31m    8  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-ec2-require-vpc-flow-logs-for-all-vpcs
[0m[0m  [2m    Impact[0m Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
[0m[0m  [2mResolution[0m Enable flow logs for VPC
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 51.01Âµs
[0m[0m  [2mparsing             [0m 749.781Âµs
[0m[0m  [2madaptation          [0m 113.965Âµs
[0m[0m  [2mchecks              [0m 22.677331ms
[0m[0m  [2mtotal               [0m 23.592087ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 11
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m1 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:03:16 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/net/NET-MISC-002-vpc-flow-logs-disabled/scan_logs/FULL_NET-MISC-002-vpc-flow-logs-disabled.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-001-s3-private-encrypted
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-001-s3-private-encrypted

============================================================
FULL SCAN LOG START: 2025-12-22 03:03:16 UTC
Scenario: STO-BENIGN-001-s3-private-encrypted
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-001-s3-private-encrypted
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-001-s3-private-encrypted"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-001-s3-private-encrypted"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_public_access_block.block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "block" {
      [32m+[0m[0m block_public_acls       = true
      [32m+[0m[0m block_public_policy     = true
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = true
      [32m+[0m[0m restrict_public_buckets = true
    }

[1m  # aws_s3_bucket_server_side_encryption_configuration.encrypt[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_server_side_encryption_configuration" "encrypt" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m rule {
          [32m+[0m[0m apply_server_side_encryption_by_default {
              [32m+[0m[0m sse_algorithm     = "AES256"
                [90m# (1 unchanged attribute hidden)[0m[0m
            }
        }
    }

[1m  # aws_s3_bucket_versioning.versioning[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_versioning" "versioning" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m versioning_configuration {
          [32m+[0m[0m mfa_delete = (known after apply)
          [32m+[0m[0m status     = "Enabled"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m5 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 11, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 11, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:26-34
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   26  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket_server_side_encryption_configuration"[0m [38;5;37m"encrypt"[0m {[0m
[0m[31m   27  [0m[0m [0m[0m   [38;5;245mbucket[0m = aws_s3_bucket.bucket.bucket[0m
[0m[31m   28  [0m[0m [0m[0m [0m
[0m[31m   29  [0m[0m [0m[0m   rule {[0m
[0m[31m   30  [0m[0m [0m[0m     apply_server_side_encryption_by_default {[0m
[0m[31m   31  [0m[0m [0m[0m       [38;5;245msse_algorithm[0m = [38;5;37m"AES256"[0m
[0m[31m   32  [0m[0m [0m[0m [0m    }[0m
[0m[31m   33  [0m[0m [0m[0m   }[0m
[0m[31m   34  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 68.621Âµs
[0m[0m  [2mparsing             [0m 1.127073ms
[0m[0m  [2madaptation          [0m 158.982Âµs
[0m[0m  [2mchecks              [0m 9.164543ms
[0m[0m  [2mtotal               [0m 10.519219ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 14
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 8
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m8 passed, 2 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:03:36 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-001-s3-private-encrypted/scan_logs/FULL_STO-BENIGN-001-s3-private-encrypted.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-002-s3-private-policy
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-002-s3-private-policy

============================================================
FULL SCAN LOG START: 2025-12-22 03:03:36 UTC
Scenario: STO-BENIGN-002-s3-private-policy
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-002-s3-private-policy
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====
[0m[1mdata.aws_caller_identity.current: Reading...[0m[0m
[0m[1mdata.aws_caller_identity.current: Read complete after 0s [id=688567271421][0m

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-002-s3-private-policy"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-002-s3-private-policy"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_policy.account_only[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_policy" "account_only" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)
      [32m+[0m[0m policy = (known after apply)
    }

[1m  # aws_s3_bucket_public_access_block.block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "block" {
      [32m+[0m[0m block_public_acls       = true
      [32m+[0m[0m block_public_policy     = true
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = true
      [32m+[0m[0m restrict_public_buckets = true
    }

[1m  # aws_s3_bucket_server_side_encryption_configuration.encrypt[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_server_side_encryption_configuration" "encrypt" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m rule {
          [32m+[0m[0m apply_server_side_encryption_by_default {
              [32m+[0m[0m sse_algorithm     = "AES256"
                [90m# (1 unchanged attribute hidden)[0m[0m
            }
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m5 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 11, Failed checks: 6, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:11-18
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:11-18
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:11-18
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:11-18
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket_policy.account_only
	File: /main.tf:30-47
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:5-9

		5 | resource "aws_s3_bucket" "bucket" {
		6 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		7 |   force_destroy = true
		8 |   tags          = local.common_tags
		9 | }

terraform_plan scan results:

Passed checks: 11, Failed checks: 6, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket_policy.account_only
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:20-28
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   20  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket_server_side_encryption_configuration"[0m [38;5;37m"encrypt"[0m {[0m
[0m[31m   21  [0m[0m [0m[0m   [38;5;245mbucket[0m = aws_s3_bucket.bucket.bucket[0m
[0m[31m   22  [0m[0m [0m[0m [0m
[0m[31m   23  [0m[0m [0m[0m   rule {[0m
[0m[31m   24  [0m[0m [0m[0m     apply_server_side_encryption_by_default {[0m
[0m[31m   25  [0m[0m [0m[0m       [38;5;245msse_algorithm[0m = [38;5;37m"AES256"[0m
[0m[31m   26  [0m[0m [0m[0m [0m    }[0m
[0m[31m   27  [0m[0m [0m[0m   }[0m
[0m[31m   28  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:5-9
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    5  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    6  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    7  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    8  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    9  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:5-9
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    5  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    6  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    7  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    8  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    9  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 52.046Âµs
[0m[0m  [2mparsing             [0m 777.881Âµs
[0m[0m  [2madaptation          [0m 115.395Âµs
[0m[0m  [2mchecks              [0m 5.062736ms
[0m[0m  [2mtotal               [0m 6.008058ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 15
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 7
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m7 passed, 3 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:03:56 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-002-s3-private-policy/scan_logs/FULL_STO-BENIGN-002-s3-private-policy.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-003-rds-backup-retention
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-003-rds-backup-retention

============================================================
FULL SCAN LOG START: 2025-12-22 03:03:56 UTC
Scenario: STO-BENIGN-003-rds-backup-retention
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-003-rds-backup-retention
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_db_instance.rds[0m will be created
[0m  [32m+[0m[0m resource "aws_db_instance" "rds" {
      [32m+[0m[0m address                               = (known after apply)
      [32m+[0m[0m allocated_storage                     = 20
      [32m+[0m[0m apply_immediately                     = false
      [32m+[0m[0m arn                                   = (known after apply)
      [32m+[0m[0m auto_minor_version_upgrade            = true
      [32m+[0m[0m availability_zone                     = (known after apply)
      [32m+[0m[0m backup_retention_period               = 7
      [32m+[0m[0m backup_target                         = (known after apply)
      [32m+[0m[0m backup_window                         = (known after apply)
      [32m+[0m[0m ca_cert_identifier                    = (known after apply)
      [32m+[0m[0m character_set_name                    = (known after apply)
      [32m+[0m[0m copy_tags_to_snapshot                 = false
      [32m+[0m[0m database_insights_mode                = (known after apply)
      [32m+[0m[0m db_name                               = (known after apply)
      [32m+[0m[0m db_subnet_group_name                  = (known after apply)
      [32m+[0m[0m dedicated_log_volume                  = false
      [32m+[0m[0m delete_automated_backups              = true
      [32m+[0m[0m domain_fqdn                           = (known after apply)
      [32m+[0m[0m endpoint                              = (known after apply)
      [32m+[0m[0m engine                                = "mysql"
      [32m+[0m[0m engine_lifecycle_support              = (known after apply)
      [32m+[0m[0m engine_version                        = "8.0"
      [32m+[0m[0m engine_version_actual                 = (known after apply)
      [32m+[0m[0m hosted_zone_id                        = (known after apply)
      [32m+[0m[0m id                                    = (known after apply)
      [32m+[0m[0m identifier                            = (known after apply)
      [32m+[0m[0m identifier_prefix                     = (known after apply)
      [32m+[0m[0m instance_class                        = "db.t3.micro"
      [32m+[0m[0m iops                                  = (known after apply)
      [32m+[0m[0m kms_key_id                            = (known after apply)
      [32m+[0m[0m latest_restorable_time                = (known after apply)
      [32m+[0m[0m license_model                         = (known after apply)
      [32m+[0m[0m listener_endpoint                     = (known after apply)
      [32m+[0m[0m maintenance_window                    = (known after apply)
      [32m+[0m[0m master_user_secret                    = (known after apply)
      [32m+[0m[0m master_user_secret_kms_key_id         = (known after apply)
      [32m+[0m[0m monitoring_interval                   = 0
      [32m+[0m[0m monitoring_role_arn                   = (known after apply)
      [32m+[0m[0m multi_az                              = (known after apply)
      [32m+[0m[0m nchar_character_set_name              = (known after apply)
      [32m+[0m[0m network_type                          = (known after apply)
      [32m+[0m[0m option_group_name                     = (known after apply)
      [32m+[0m[0m parameter_group_name                  = (known after apply)
      [32m+[0m[0m password                              = (sensitive value)
      [32m+[0m[0m password_wo                           = (write-only attribute)
      [32m+[0m[0m performance_insights_enabled          = false
      [32m+[0m[0m performance_insights_kms_key_id       = (known after apply)
      [32m+[0m[0m performance_insights_retention_period = (known after apply)
      [32m+[0m[0m port                                  = (known after apply)
      [32m+[0m[0m publicly_accessible                   = false
      [32m+[0m[0m replica_mode                          = (known after apply)
      [32m+[0m[0m replicas                              = (known after apply)
      [32m+[0m[0m resource_id                           = (known after apply)
      [32m+[0m[0m skip_final_snapshot                   = true
      [32m+[0m[0m snapshot_identifier                   = (known after apply)
      [32m+[0m[0m status                                = (known after apply)
      [32m+[0m[0m storage_throughput                    = (known after apply)
      [32m+[0m[0m storage_type                          = (known after apply)
      [32m+[0m[0m tags                                  = {
          [32m+[0m[0m "cis_controls" = "RDS.2"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-003-rds-backup-retention"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                              = {
          [32m+[0m[0m "cis_controls" = "RDS.2"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-003-rds-backup-retention"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m timezone                              = (known after apply)
      [32m+[0m[0m username                              = "adminuser"
      [32m+[0m[0m vpc_security_group_ids                = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1m  # random_password.db[0m will be created
[0m  [32m+[0m[0m resource "random_password" "db" {
      [32m+[0m[0m bcrypt_hash = (sensitive value)
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m length      = 16
      [32m+[0m[0m lower       = true
      [32m+[0m[0m min_lower   = 0
      [32m+[0m[0m min_numeric = 0
      [32m+[0m[0m min_special = 0
      [32m+[0m[0m min_upper   = 0
      [32m+[0m[0m number      = true
      [32m+[0m[0m numeric     = true
      [32m+[0m[0m result      = (sensitive value)
      [32m+[0m[0m special     = true
      [32m+[0m[0m upper       = true
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 7, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   backup_retention_period = 7
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

terraform_plan scan results:

Passed checks: 8, Failed checks: 7, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mInstance does not have storage encryption enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-encrypt-instance-storage-data
[0m[0m  [2m    Impact[0m Data can be read from RDS instances if compromised
[0m[0m  [2mResolution[0m Enable encryption for RDS instances
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have IAM Authentication enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0176
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have Deletion Protection enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0177
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[97mLOW[39m[0m [1mInstance does not have performance insights enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-enable-performance-insights
[0m[0m  [2m    Impact[0m Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
[0m[0m  [2mResolution[0m Enable performance insights
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 35.826Âµs
[0m[0m  [2mparsing             [0m 627.786Âµs
[0m[0m  [2madaptation          [0m 84.556Âµs
[0m[0m  [2mchecks              [0m 8.73087ms
[0m[0m  [2mtotal               [0m 9.479038ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 3
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m3 passed, 4 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:04:16 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-003-rds-backup-retention/scan_logs/FULL_STO-BENIGN-003-rds-backup-retention.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-004-s3-access-logging-enabled
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-004-s3-access-logging-enabled

============================================================
FULL SCAN LOG START: 2025-12-22 03:04:16 UTC
Scenario: STO-BENIGN-004-s3-access-logging-enabled
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-004-s3-access-logging-enabled
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-004-s3-access-logging-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-004-s3-access-logging-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket.log_bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "log_bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-004-s3-access-logging-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-004-s3-access-logging-enabled"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_logging.logging[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_logging" "logging" {
      [32m+[0m[0m bucket        = (known after apply)
      [32m+[0m[0m id            = (known after apply)
      [32m+[0m[0m target_bucket = (known after apply)
      [32m+[0m[0m target_prefix = "access-logs/"
    }

[1m  # aws_s3_bucket_public_access_block.block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "block" {
      [32m+[0m[0m block_public_acls       = true
      [32m+[0m[0m block_public_policy     = true
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = true
      [32m+[0m[0m restrict_public_buckets = true
    }

[1m  # aws_s3_bucket_public_access_block.log_block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "log_block" {
      [32m+[0m[0m block_public_acls       = true
      [32m+[0m[0m block_public_policy     = true
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = true
      [32m+[0m[0m restrict_public_buckets = true
    }

[1m  # aws_s3_bucket_server_side_encryption_configuration.encrypt[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_server_side_encryption_configuration" "encrypt" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m rule {
          [32m+[0m[0m apply_server_side_encryption_by_default {
              [32m+[0m[0m sse_algorithm     = "AES256"
                [90m# (1 unchanged attribute hidden)[0m[0m
            }
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m7 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 21, Failed checks: 10, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /main.tf:9-16
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /main.tf:9-16
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /main.tf:9-16
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /main.tf:9-16
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:24-31
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:24-31
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:24-31
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:24-31
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "log_bucket" {
		4 |   bucket        = lower(format("%s-logs-%s", substr(var.scenario_id, 0, 30), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22

		18 | resource "aws_s3_bucket" "bucket" {
		19 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		20 |   force_destroy = true
		21 |   tags          = local.common_tags
		22 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "log_bucket" {
		4 |   bucket        = lower(format("%s-logs-%s", substr(var.scenario_id, 0, 30), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22

		18 | resource "aws_s3_bucket" "bucket" {
		19 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		20 |   force_destroy = true
		21 |   tags          = local.common_tags
		22 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "log_bucket" {
		4 |   bucket        = lower(format("%s-logs-%s", substr(var.scenario_id, 0, 30), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22

		18 | resource "aws_s3_bucket" "bucket" {
		19 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		20 |   force_destroy = true
		21 |   tags          = local.common_tags
		22 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "log_bucket" {
		4 |   bucket        = lower(format("%s-logs-%s", substr(var.scenario_id, 0, 30), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22

		18 | resource "aws_s3_bucket" "bucket" {
		19 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		20 |   force_destroy = true
		21 |   tags          = local.common_tags
		22 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "log_bucket" {
		4 |   bucket        = lower(format("%s-logs-%s", substr(var.scenario_id, 0, 30), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:18-22

		18 | resource "aws_s3_bucket" "bucket" {
		19 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		20 |   force_destroy = true
		21 |   tags          = local.common_tags
		22 | }

terraform_plan scan results:

Passed checks: 21, Failed checks: 10, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.log_block
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.log_bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"log_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-logs-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m30[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"log_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-logs-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m30[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:33-41
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   33  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket_server_side_encryption_configuration"[0m [38;5;37m"encrypt"[0m {[0m
[0m[31m   34  [0m[0m [0m[0m   [38;5;245mbucket[0m = aws_s3_bucket.bucket.bucket[0m
[0m[31m   35  [0m[0m [0m[0m [0m
[0m[31m   36  [0m[0m [0m[0m   rule {[0m
[0m[31m   37  [0m[0m [0m[0m     apply_server_side_encryption_by_default {[0m
[0m[31m   38  [0m[0m [0m[0m       [38;5;245msse_algorithm[0m = [38;5;37m"AES256"[0m
[0m[31m   39  [0m[0m [0m[0m [0m    }[0m
[0m[31m   40  [0m[0m [0m[0m   }[0m
[0m[31m   41  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:18-22
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   18  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   20  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m   21  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m   22  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"log_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-logs-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m30[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"log_bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-logs-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m30[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 56.669Âµs
[0m[0m  [2mparsing             [0m 1.323417ms
[0m[0m  [2madaptation          [0m 188.834Âµs
[0m[0m  [2mchecks              [0m 9.129473ms
[0m[0m  [2mtotal               [0m 10.698393ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 16
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 14
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 3
[0m[0m  [2mmedium              [0m 3
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m14 passed, 6 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:04:36 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-004-s3-access-logging-enabled/scan_logs/FULL_STO-BENIGN-004-s3-access-logging-enabled.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-005-rds-encrypted-deletion-protection
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-005-rds-encrypted-deletion-protection

============================================================
FULL SCAN LOG START: 2025-12-22 03:04:36 UTC
Scenario: STO-BENIGN-005-rds-encrypted-deletion-protection
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-005-rds-encrypted-deletion-protection
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_db_instance.rds[0m will be created
[0m  [32m+[0m[0m resource "aws_db_instance" "rds" {
      [32m+[0m[0m address                               = (known after apply)
      [32m+[0m[0m allocated_storage                     = 20
      [32m+[0m[0m apply_immediately                     = false
      [32m+[0m[0m arn                                   = (known after apply)
      [32m+[0m[0m auto_minor_version_upgrade            = true
      [32m+[0m[0m availability_zone                     = (known after apply)
      [32m+[0m[0m backup_retention_period               = 7
      [32m+[0m[0m backup_target                         = (known after apply)
      [32m+[0m[0m backup_window                         = (known after apply)
      [32m+[0m[0m ca_cert_identifier                    = (known after apply)
      [32m+[0m[0m character_set_name                    = (known after apply)
      [32m+[0m[0m copy_tags_to_snapshot                 = false
      [32m+[0m[0m database_insights_mode                = (known after apply)
      [32m+[0m[0m db_name                               = (known after apply)
      [32m+[0m[0m db_subnet_group_name                  = (known after apply)
      [32m+[0m[0m dedicated_log_volume                  = false
      [32m+[0m[0m delete_automated_backups              = true
      [32m+[0m[0m deletion_protection                   = true
      [32m+[0m[0m domain_fqdn                           = (known after apply)
      [32m+[0m[0m endpoint                              = (known after apply)
      [32m+[0m[0m engine                                = "mysql"
      [32m+[0m[0m engine_lifecycle_support              = (known after apply)
      [32m+[0m[0m engine_version                        = "8.0"
      [32m+[0m[0m engine_version_actual                 = (known after apply)
      [32m+[0m[0m hosted_zone_id                        = (known after apply)
      [32m+[0m[0m id                                    = (known after apply)
      [32m+[0m[0m identifier                            = (known after apply)
      [32m+[0m[0m identifier_prefix                     = (known after apply)
      [32m+[0m[0m instance_class                        = "db.t3.micro"
      [32m+[0m[0m iops                                  = (known after apply)
      [32m+[0m[0m kms_key_id                            = (known after apply)
      [32m+[0m[0m latest_restorable_time                = (known after apply)
      [32m+[0m[0m license_model                         = (known after apply)
      [32m+[0m[0m listener_endpoint                     = (known after apply)
      [32m+[0m[0m maintenance_window                    = (known after apply)
      [32m+[0m[0m master_user_secret                    = (known after apply)
      [32m+[0m[0m master_user_secret_kms_key_id         = (known after apply)
      [32m+[0m[0m monitoring_interval                   = 0
      [32m+[0m[0m monitoring_role_arn                   = (known after apply)
      [32m+[0m[0m multi_az                              = (known after apply)
      [32m+[0m[0m nchar_character_set_name              = (known after apply)
      [32m+[0m[0m network_type                          = (known after apply)
      [32m+[0m[0m option_group_name                     = (known after apply)
      [32m+[0m[0m parameter_group_name                  = (known after apply)
      [32m+[0m[0m password                              = (sensitive value)
      [32m+[0m[0m password_wo                           = (write-only attribute)
      [32m+[0m[0m performance_insights_enabled          = false
      [32m+[0m[0m performance_insights_kms_key_id       = (known after apply)
      [32m+[0m[0m performance_insights_retention_period = (known after apply)
      [32m+[0m[0m port                                  = (known after apply)
      [32m+[0m[0m publicly_accessible                   = false
      [32m+[0m[0m replica_mode                          = (known after apply)
      [32m+[0m[0m replicas                              = (known after apply)
      [32m+[0m[0m resource_id                           = (known after apply)
      [32m+[0m[0m skip_final_snapshot                   = true
      [32m+[0m[0m snapshot_identifier                   = (known after apply)
      [32m+[0m[0m status                                = (known after apply)
      [32m+[0m[0m storage_encrypted                     = true
      [32m+[0m[0m storage_throughput                    = (known after apply)
      [32m+[0m[0m storage_type                          = (known after apply)
      [32m+[0m[0m tags                                  = {
          [32m+[0m[0m "cis_controls" = "RDS.3"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-005-rds-encrypted-deletion-protection"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m tags_all                              = {
          [32m+[0m[0m "cis_controls" = "RDS.3"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-BENIGN-005-rds-encrypted-deletion-protection"
          [32m+[0m[0m "type"         = "BENIGN"
        }
      [32m+[0m[0m timezone                              = (known after apply)
      [32m+[0m[0m username                              = "adminuser"
      [32m+[0m[0m vpc_security_group_ids                = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1m  # random_password.db[0m will be created
[0m  [32m+[0m[0m resource "random_password" "db" {
      [32m+[0m[0m bcrypt_hash = (sensitive value)
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m length      = 16
      [32m+[0m[0m lower       = true
      [32m+[0m[0m min_lower   = 0
      [32m+[0m[0m min_numeric = 0
      [32m+[0m[0m min_special = 0
      [32m+[0m[0m min_upper   = 0
      [32m+[0m[0m number      = true
      [32m+[0m[0m numeric     = true
      [32m+[0m[0m result      = (sensitive value)
      [32m+[0m[0m special     = true
      [32m+[0m[0m upper       = true
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 9, Failed checks: 6, Skipped checks: 0

Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted   = true
		19 |   deletion_protection = true
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

terraform_plan scan results:

Passed checks: 10, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have IAM Authentication enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0176
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[97mLOW[39m[0m [1mInstance does not have performance insights enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-enable-performance-insights
[0m[0m  [2m    Impact[0m Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
[0m[0m  [2mResolution[0m Enable performance insights
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 36.1Âµs
[0m[0m  [2mparsing             [0m 608.559Âµs
[0m[0m  [2madaptation          [0m 83.224Âµs
[0m[0m  [2mchecks              [0m 48.197697ms
[0m[0m  [2mtotal               [0m 48.92558ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 5
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m5 passed, 2 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:04:56 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-BENIGN-005-rds-encrypted-deletion-protection/scan_logs/FULL_STO-BENIGN-005-rds-encrypted-deletion-protection.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-001-s3-public-unencrypted
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-001-s3-public-unencrypted

============================================================
FULL SCAN LOG START: 2025-12-22 03:04:56 UTC
Scenario: STO-MISC-001-s3-public-unencrypted
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-001-s3-public-unencrypted
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.public_bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "public_bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17, s3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-001-s3-public-unencrypted"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.17, s3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-001-s3-public-unencrypted"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_acl.public_read[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_acl" "public_read" {
      [32m+[0m[0m acl    = "public-read"
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m access_control_policy (known after apply)
    }

[1m  # aws_s3_bucket_ownership_controls.ownership[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_ownership_controls" "ownership" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m rule {
          [32m+[0m[0m object_ownership = "BucketOwnerPreferred"
        }
    }

[1m  # aws_s3_bucket_public_access_block.no_block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "no_block" {
      [32m+[0m[0m block_public_acls       = false
      [32m+[0m[0m block_public_policy     = false
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = false
      [32m+[0m[0m restrict_public_buckets = false
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m5 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 6, Failed checks: 13, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20
Check: CKV_AWS_375: "Ensure AWS S3 bucket does not have global view ACL permissions enabled"
	PASSED for resource: aws_s3_bucket_acl.public_read
	File: /main.tf:42-49
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_43: "Ensure S3 Bucket does not allow access to all Authenticated users"
	PASSED for resource: aws_s3_bucket_acl.public_read
	File: /main.tf:42-49
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /main.tf:32-39

		32 | resource "aws_s3_bucket_public_access_block" "no_block" {
		33 |   bucket = aws_s3_bucket.public_bucket.id
		34 | 
		35 |   block_public_acls       = false
		36 |   block_public_policy     = false
		37 |   ignore_public_acls      = false
		38 |   restrict_public_buckets = false
		39 | }

Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /main.tf:32-39

		32 | resource "aws_s3_bucket_public_access_block" "no_block" {
		33 |   bucket = aws_s3_bucket.public_bucket.id
		34 | 
		35 |   block_public_acls       = false
		36 |   block_public_policy     = false
		37 |   ignore_public_acls      = false
		38 |   restrict_public_buckets = false
		39 | }

Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /main.tf:32-39

		32 | resource "aws_s3_bucket_public_access_block" "no_block" {
		33 |   bucket = aws_s3_bucket.public_bucket.id
		34 | 
		35 |   block_public_acls       = false
		36 |   block_public_policy     = false
		37 |   ignore_public_acls      = false
		38 |   restrict_public_buckets = false
		39 | }

Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /main.tf:32-39

		32 | resource "aws_s3_bucket_public_access_block" "no_block" {
		33 |   bucket = aws_s3_bucket.public_bucket.id
		34 | 
		35 |   block_public_acls       = false
		36 |   block_public_policy     = false
		37 |   ignore_public_acls      = false
		38 |   restrict_public_buckets = false
		39 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV2_AWS_65: "Ensure access control lists for S3 buckets are disabled"
	FAILED for resource: aws_s3_bucket_ownership_controls.ownership
	File: /main.tf:23-29

		23 | resource "aws_s3_bucket_ownership_controls" "ownership" {
		24 |   bucket = aws_s3_bucket.public_bucket.id
		25 | 
		26 |   rule {
		27 |     object_ownership = "BucketOwnerPreferred"
		28 |   }
		29 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /main.tf:15-20

		15 | resource "aws_s3_bucket" "public_bucket" {
		16 |   bucket        = lower(format("%s-%s", substr(replace(var.scenario_id, "_", "-"), 0, 40), local.name_suffix))
		17 |   force_destroy = true
		18 | 
		19 |   tags = local.common_tags
		20 | }

terraform_plan scan results:

Passed checks: 6, Failed checks: 13, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_375: "Ensure AWS S3 bucket does not have global view ACL permissions enabled"
	PASSED for resource: aws_s3_bucket_acl.public_read
	File: /tfplan.json:0-0
Check: CKV2_AWS_43: "Ensure S3 Bucket does not allow access to all Authenticated users"
	PASSED for resource: aws_s3_bucket_acl.public_read
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	FAILED for resource: aws_s3_bucket_public_access_block.no_block
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_65: "Ensure access control lists for S3 buckets are disabled"
	FAILED for resource: aws_s3_bucket_ownership_controls.ownership
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.public_bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:15-20
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   15  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"public_bucket"[0m {[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mreplace[0m([38;5;33mvar[0m.scenario_id, [38;5;37m"_"[0m, [38;5;37m"-"[0m), [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   17  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m   18  [0m[0m [0m[0m [0m[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   20  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:15-20
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   15  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"public_bucket"[0m {[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mreplace[0m([38;5;33mvar[0m.scenario_id, [38;5;37m"_"[0m, [38;5;37m"-"[0m), [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   17  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m   18  [0m[0m [0m[0m [0m[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   20  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mPublic access block does not block public ACLs[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:35
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   32  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"no_block"[0m {[0m
[0m[90m   33  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.public_bucket.id[0m
[0m[90m   34  [0m[0m  [0m
[0m[31m   35  [0m[0m[31m[[39m[0m[0m   [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   36  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[90m   37  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[90m   38  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   39  [0m[0m  [0m}[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[31mHIGH[39m[0m [1mPublic access block does not block public policies[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:36
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   32  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"no_block"[0m {[0m
[0m[90m   33  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.public_bucket.id[0m
[0m[90m   34  [0m[0m  [0m
[0m[90m   35  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[31m   36  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   37  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[90m   38  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   39  [0m[0m  [0m}[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mPublic access block does not ignore public ACLs[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:37
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   32  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"no_block"[0m {[0m
[0m[90m   33  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.public_bucket.id[0m
[0m[90m   34  [0m[0m  [0m
[0m[90m   35  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[90m   36  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[31m   37  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m[0m [3m[3m[2m(false)[0m
[0m[90m   38  [0m[0m  [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m
[0m[90m   39  [0m[0m  [0m}[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mPublic access block does not restrict public buckets[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:38
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   32  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_public_access_block"[0m [38;5;37m"no_block"[0m {[0m
[0m[90m   33  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.public_bucket.id[0m
[0m[90m   34  [0m[0m  [0m
[0m[90m   35  [0m[0m    [38;5;245mblock_public_acls[0m       = [38;5;166mfalse[0m
[0m[90m   36  [0m[0m  [0m  [38;5;245mblock_public_policy[0m     = [38;5;166mfalse[0m
[0m[90m   37  [0m[0m  [0m  [38;5;245mignore_public_acls[0m      = [38;5;166mfalse[0m
[0m[31m   38  [0m[0m[31m[[39m[0m[0m [0m  [38;5;245mrestrict_public_buckets[0m = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   39  [0m[0m  [0m}[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mBucket has a public ACL: 'public-read'.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:44
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m   42  [0m[0m  [0m[38;5;33mresource[0m [38;5;37m"aws_s3_bucket_acl"[0m [38;5;37m"public_read"[0m {[0m
[0m[90m   43  [0m[0m    [38;5;245mbucket[0m = aws_s3_bucket.public_bucket.id[0m
[0m[31m   44  [0m[0m[31m[[39m[0m[0m   [38;5;245macl[0m    = [38;5;37m"public-read"[0m[0m [3m[2m[3m("public-read")[0m
[0m[90m   45  [0m[0m  [0m[0m
[0m[90m   46  [0m[0m    [38;5;245mdepends_on[0m = [[0m
[0m[90m   47  [0m[0m      aws_s3_bucket_ownership_controls.ownership[0m
[0m[90m   48  [0m[0m    ][0m
[0m[90m   49  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-access-with-acl
[0m[0m  [2m    Impact[0m Public access to the bucket can lead to data leakage
[0m[0m  [2mResolution[0m Don't use canned ACLs or switch to private acl
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-access-with-acl/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #8[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:15-20
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   15  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"public_bucket"[0m {[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mreplace[0m([38;5;33mvar[0m.scenario_id, [38;5;37m"_"[0m, [38;5;37m"-"[0m), [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   17  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m   18  [0m[0m [0m[0m [0m[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   20  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #9[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:15-20
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   15  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"public_bucket"[0m {[0m
[0m[31m   16  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mreplace[0m([38;5;33mvar[0m.scenario_id, [38;5;37m"_"[0m, [38;5;37m"-"[0m), [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   17  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m   18  [0m[0m [0m[0m [0m[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mtags[0m = local.common_tags[0m
[0m[31m   20  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 58.313Âµs
[0m[0m  [2mparsing             [0m 1.392097ms
[0m[0m  [2madaptation          [0m 161.304Âµs
[0m[0m  [2mchecks              [0m 9.853751ms
[0m[0m  [2mtotal               [0m 11.465465ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 14
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 7
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m1 passed, 9 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)
[31mFAIL[0m - tfplan.json - main - S3 bucket ACL public_read is public-read (NOT allowed) [plan]

[31m21 tests, 18 passed, 0 warnings, 3 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:05:16 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-001-s3-public-unencrypted/scan_logs/FULL_STO-MISC-001-s3-public-unencrypted.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-002-s3-public-policy
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-002-s3-public-policy

============================================================
FULL SCAN LOG START: 2025-12-22 03:05:16 UTC
Scenario: STO-MISC-002-s3-public-policy
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-002-s3-public-policy
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.1"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-002-s3-public-policy"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.8,S3.1"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-002-s3-public-policy"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_policy.public_read_policy[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_policy" "public_read_policy" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)
      [32m+[0m[0m policy = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 6, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket_policy.public_read_policy
	File: /main.tf:9-24
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_70: "Ensure S3 bucket does not allow an action with any Principal"
	FAILED for resource: aws_s3_bucket_policy.public_read_policy
	File: /main.tf:9-24

		9  | resource "aws_s3_bucket_policy" "public_read_policy" {
		10 |   bucket = aws_s3_bucket.bucket.id
		11 | 
		12 |   policy = jsonencode({
		13 |     Version = "2012-10-17"
		14 |     Statement = [
		15 |       {
		16 |         Sid       = "PublicReadGetObject"
		17 |         Effect    = "Allow"
		18 |         Principal = "*"
		19 |         Action    = "s3:GetObject"
		20 |         Resource  = "${aws_s3_bucket.bucket.arn}/*"
		21 |       }
		22 |     ]
		23 |   })
		24 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 6, Failed checks: 7, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket_policy.public_read_policy
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #7[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #8[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #9[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 55.018Âµs
[0m[0m  [2mparsing             [0m 1.137907ms
[0m[0m  [2madaptation          [0m 506.382Âµs
[0m[0m  [2mchecks              [0m 25.023176ms
[0m[0m  [2mtotal               [0m 26.722483ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 1
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 6
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m1 passed, 9 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:05:36 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-002-s3-public-policy/scan_logs/FULL_STO-MISC-002-s3-public-policy.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-003-rds-no-backup-retention
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-003-rds-no-backup-retention

============================================================
FULL SCAN LOG START: 2025-12-22 03:05:36 UTC
Scenario: STO-MISC-003-rds-no-backup-retention
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-003-rds-no-backup-retention
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_db_instance.rds[0m will be created
[0m  [32m+[0m[0m resource "aws_db_instance" "rds" {
      [32m+[0m[0m address                               = (known after apply)
      [32m+[0m[0m allocated_storage                     = 20
      [32m+[0m[0m apply_immediately                     = false
      [32m+[0m[0m arn                                   = (known after apply)
      [32m+[0m[0m auto_minor_version_upgrade            = true
      [32m+[0m[0m availability_zone                     = (known after apply)
      [32m+[0m[0m backup_retention_period               = 0
      [32m+[0m[0m backup_target                         = (known after apply)
      [32m+[0m[0m backup_window                         = (known after apply)
      [32m+[0m[0m ca_cert_identifier                    = (known after apply)
      [32m+[0m[0m character_set_name                    = (known after apply)
      [32m+[0m[0m copy_tags_to_snapshot                 = false
      [32m+[0m[0m database_insights_mode                = (known after apply)
      [32m+[0m[0m db_name                               = (known after apply)
      [32m+[0m[0m db_subnet_group_name                  = (known after apply)
      [32m+[0m[0m dedicated_log_volume                  = false
      [32m+[0m[0m delete_automated_backups              = true
      [32m+[0m[0m domain_fqdn                           = (known after apply)
      [32m+[0m[0m endpoint                              = (known after apply)
      [32m+[0m[0m engine                                = "mysql"
      [32m+[0m[0m engine_lifecycle_support              = (known after apply)
      [32m+[0m[0m engine_version                        = "8.0"
      [32m+[0m[0m engine_version_actual                 = (known after apply)
      [32m+[0m[0m hosted_zone_id                        = (known after apply)
      [32m+[0m[0m id                                    = (known after apply)
      [32m+[0m[0m identifier                            = (known after apply)
      [32m+[0m[0m identifier_prefix                     = (known after apply)
      [32m+[0m[0m instance_class                        = "db.t3.micro"
      [32m+[0m[0m iops                                  = (known after apply)
      [32m+[0m[0m kms_key_id                            = (known after apply)
      [32m+[0m[0m latest_restorable_time                = (known after apply)
      [32m+[0m[0m license_model                         = (known after apply)
      [32m+[0m[0m listener_endpoint                     = (known after apply)
      [32m+[0m[0m maintenance_window                    = (known after apply)
      [32m+[0m[0m master_user_secret                    = (known after apply)
      [32m+[0m[0m master_user_secret_kms_key_id         = (known after apply)
      [32m+[0m[0m monitoring_interval                   = 0
      [32m+[0m[0m monitoring_role_arn                   = (known after apply)
      [32m+[0m[0m multi_az                              = (known after apply)
      [32m+[0m[0m nchar_character_set_name              = (known after apply)
      [32m+[0m[0m network_type                          = (known after apply)
      [32m+[0m[0m option_group_name                     = (known after apply)
      [32m+[0m[0m parameter_group_name                  = (known after apply)
      [32m+[0m[0m password                              = (sensitive value)
      [32m+[0m[0m password_wo                           = (write-only attribute)
      [32m+[0m[0m performance_insights_enabled          = false
      [32m+[0m[0m performance_insights_kms_key_id       = (known after apply)
      [32m+[0m[0m performance_insights_retention_period = (known after apply)
      [32m+[0m[0m port                                  = (known after apply)
      [32m+[0m[0m publicly_accessible                   = false
      [32m+[0m[0m replica_mode                          = (known after apply)
      [32m+[0m[0m replicas                              = (known after apply)
      [32m+[0m[0m resource_id                           = (known after apply)
      [32m+[0m[0m skip_final_snapshot                   = true
      [32m+[0m[0m snapshot_identifier                   = (known after apply)
      [32m+[0m[0m status                                = (known after apply)
      [32m+[0m[0m storage_throughput                    = (known after apply)
      [32m+[0m[0m storage_type                          = (known after apply)
      [32m+[0m[0m tags                                  = {
          [32m+[0m[0m "cis_controls" = "RDS.2"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-003-rds-no-backup-retention"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                              = {
          [32m+[0m[0m "cis_controls" = "RDS.2"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-003-rds-no-backup-retention"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m timezone                              = (known after apply)
      [32m+[0m[0m username                              = "adminuser"
      [32m+[0m[0m vpc_security_group_ids                = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1m  # random_password.db[0m will be created
[0m  [32m+[0m[0m resource "random_password" "db" {
      [32m+[0m[0m bcrypt_hash = (sensitive value)
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m length      = 16
      [32m+[0m[0m lower       = true
      [32m+[0m[0m min_lower   = 0
      [32m+[0m[0m min_numeric = 0
      [32m+[0m[0m min_special = 0
      [32m+[0m[0m min_upper   = 0
      [32m+[0m[0m number      = true
      [32m+[0m[0m numeric     = true
      [32m+[0m[0m result      = (sensitive value)
      [32m+[0m[0m special     = true
      [32m+[0m[0m upper       = true
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 6, Failed checks: 9, Skipped checks: 0

Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-23
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-23

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier             = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine                 = "mysql"
		11 |   engine_version         = "8.0"
		12 |   instance_class         = "db.t3.micro"
		13 |   allocated_storage      = 20
		14 | 
		15 |   username               = "adminuser"
		16 |   password               = random_password.db.result
		17 | 
		18 |   backup_retention_period = 0
		19 |   skip_final_snapshot     = true
		20 |   publicly_accessible     = false
		21 | 
		22 |   tags = local.common_tags
		23 | }

terraform_plan scan results:

Passed checks: 7, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mInstance does not have storage encryption enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m             = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m                 = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m         = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m         = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m      = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m               = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m               = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-encrypt-instance-storage-data
[0m[0m  [2m    Impact[0m Data can be read from RDS instances if compromised
[0m[0m  [2mResolution[0m Enable encryption for RDS instances
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mInstance has very low backup retention period.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:18
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m    8  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[90m    .  [0m
[0m[31m   18  [0m[0m[31m[[39m[0m[0m   [38;5;245mbackup_retention_period[0m = [38;5;37m0[0m[0m [3m[3m[2m(0)[0m
[0m[90m   ..  [0m
[0m[90m   23  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-specify-backup-retention
[0m[0m  [2m    Impact[0m Potential loss of data and short opportunity for recovery
[0m[0m  [2mResolution[0m Explicitly set the retention period to greater than the default
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/specify-backup-retention/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have IAM Authentication enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m             = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m                 = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m         = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m         = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m      = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m               = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m               = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0176
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have Deletion Protection enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m             = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m                 = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m         = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m         = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m      = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m               = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m               = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0177
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #5[0m [0m[97mLOW[39m[0m [1mInstance does not have performance insights enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[3m[2m:8-23
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m             = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m                 = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m         = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m         = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m      = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m               = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m               = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-enable-performance-insights
[0m[0m  [2m    Impact[0m Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
[0m[0m  [2mResolution[0m Enable performance insights
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 56.036Âµs
[0m[0m  [2mparsing             [0m 1.00417ms
[0m[0m  [2madaptation          [0m 128.081Âµs
[0m[0m  [2mchecks              [0m 14.915308ms
[0m[0m  [2mtotal               [0m 16.103595ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 2
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 3
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m2 passed, 5 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:05:56 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-003-rds-no-backup-retention/scan_logs/FULL_STO-MISC-003-rds-no-backup-retention.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-004-s3-access-logging-disabled
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-004-s3-access-logging-disabled

============================================================
FULL SCAN LOG START: 2025-12-22 03:05:57 UTC
Scenario: STO-MISC-004-s3-access-logging-disabled
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-004-s3-access-logging-disabled
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/random versions matching "~> 3.6"...
- Finding hashicorp/aws versions matching "~> 5.0"...
- Using previously-installed hashicorp/random v3.7.2
- Using previously-installed hashicorp/aws v5.100.0

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_s3_bucket.bucket[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket" "bucket" {
      [32m+[0m[0m acceleration_status         = (known after apply)
      [32m+[0m[0m acl                         = (known after apply)
      [32m+[0m[0m arn                         = (known after apply)
      [32m+[0m[0m bucket                      = (known after apply)
      [32m+[0m[0m bucket_domain_name          = (known after apply)
      [32m+[0m[0m bucket_prefix               = (known after apply)
      [32m+[0m[0m bucket_regional_domain_name = (known after apply)
      [32m+[0m[0m force_destroy               = true
      [32m+[0m[0m hosted_zone_id              = (known after apply)
      [32m+[0m[0m id                          = (known after apply)
      [32m+[0m[0m object_lock_enabled         = (known after apply)
      [32m+[0m[0m policy                      = (known after apply)
      [32m+[0m[0m region                      = (known after apply)
      [32m+[0m[0m request_payer               = (known after apply)
      [32m+[0m[0m tags                        = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-004-s3-access-logging-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                    = {
          [32m+[0m[0m "cis_controls" = "S3.9"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-004-s3-access-logging-disabled"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m website_domain              = (known after apply)
      [32m+[0m[0m website_endpoint            = (known after apply)

      [32m+[0m[0m cors_rule (known after apply)

      [32m+[0m[0m grant (known after apply)

      [32m+[0m[0m lifecycle_rule (known after apply)

      [32m+[0m[0m logging (known after apply)

      [32m+[0m[0m object_lock_configuration (known after apply)

      [32m+[0m[0m replication_configuration (known after apply)

      [32m+[0m[0m server_side_encryption_configuration (known after apply)

      [32m+[0m[0m versioning (known after apply)

      [32m+[0m[0m website (known after apply)
    }

[1m  # aws_s3_bucket_public_access_block.block[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_public_access_block" "block" {
      [32m+[0m[0m block_public_acls       = true
      [32m+[0m[0m block_public_policy     = true
      [32m+[0m[0m bucket                  = (known after apply)
      [32m+[0m[0m id                      = (known after apply)
      [32m+[0m[0m ignore_public_acls      = true
      [32m+[0m[0m restrict_public_buckets = true
    }

[1m  # aws_s3_bucket_server_side_encryption_configuration.encrypt[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_server_side_encryption_configuration" "encrypt" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m rule {
          [32m+[0m[0m apply_server_side_encryption_by_default {
              [32m+[0m[0m sse_algorithm     = "AES256"
                [90m# (1 unchanged attribute hidden)[0m[0m
            }
        }
    }

[1m  # aws_s3_bucket_versioning.versioning[0m will be created
[0m  [32m+[0m[0m resource "aws_s3_bucket_versioning" "versioning" {
      [32m+[0m[0m bucket = (known after apply)
      [32m+[0m[0m id     = (known after apply)

      [32m+[0m[0m versioning_configuration {
          [32m+[0m[0m mfa_delete = (known after apply)
          [32m+[0m[0m status     = "Enabled"
        }
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1mPlan:[0m [0m5 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 11, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /main.tf:9-16
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /main.tf:3-7

		3 | resource "aws_s3_bucket" "bucket" {
		4 |   bucket        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		5 |   force_destroy = true
		6 |   tags          = local.common_tags
		7 | }

terraform_plan scan results:

Passed checks: 11, Failed checks: 5, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_93: "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_55: "Ensure S3 bucket has ignore public ACLs enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_54: "Ensure S3 bucket has block public policy enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_53: "Ensure S3 bucket has block public ACLS enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV_AWS_56: "Ensure S3 bucket has 'restrict_public_buckets' enabled"
	PASSED for resource: aws_s3_bucket_public_access_block.block
	File: /tfplan.json:0-0
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_57: "S3 Bucket has an ACL defined which allows public WRITE access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_20: "S3 Bucket has an ACL defined which allows public READ access."
	PASSED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.bucket
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:18-26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   18  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket_server_side_encryption_configuration"[0m [38;5;37m"encrypt"[0m {[0m
[0m[31m   19  [0m[0m [0m[0m   [38;5;245mbucket[0m = aws_s3_bucket.bucket.bucket[0m
[0m[31m   20  [0m[0m [0m[0m [0m
[0m[31m   21  [0m[0m [0m[0m   rule {[0m
[0m[31m   22  [0m[0m [0m[0m     apply_server_side_encryption_by_default {[0m
[0m[31m   23  [0m[0m [0m[0m       [38;5;245msse_algorithm[0m = [38;5;37m"AES256"[0m
[0m[31m   24  [0m[0m [0m[0m [0m    }[0m
[0m[31m   25  [0m[0m [0m[0m   }[0m
[0m[31m   26  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:3-7
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    3  [0m[0m [0m[0m [38;5;33mresource[0m [38;5;37m"aws_s3_bucket"[0m [38;5;37m"bucket"[0m {[0m
[0m[31m    4  [0m[0m [0m[0m   [38;5;245mbucket[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m    5  [0m[0m [0m[0m   [38;5;245mforce_destroy[0m = [38;5;166mtrue[0m
[0m[31m    6  [0m[0m [0m[0m [0m  [38;5;245mtags[0m          = local.common_tags[0m
[0m[31m    7  [0m[0m [0m[0m }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 59.159Âµs
[0m[0m  [2mparsing             [0m 1.088595ms
[0m[0m  [2madaptation          [0m 159.002Âµs
[0m[0m  [2mchecks              [0m 13.471946ms
[0m[0m  [2mtotal               [0m 14.778702ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 14
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 8
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 1
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m8 passed, 2 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:06:17 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-004-s3-access-logging-disabled/scan_logs/FULL_STO-MISC-004-s3-access-logging-disabled.log
============================================================


============================================================
Running scenario: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-005-rds-unencrypted-no-deletion-protection
============================================================
==> Scenario directory: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-005-rds-unencrypted-no-deletion-protection

============================================================
FULL SCAN LOG START: 2025-12-22 03:06:17 UTC
Scenario: STO-MISC-005-rds-unencrypted-no-deletion-protection
Path: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-005-rds-unencrypted-no-deletion-protection
============================================================

===== [1] Terraform init =====
[0m[1mInitializing the backend...[0m
[0m[1mInitializing provider plugins...[0m
- Finding hashicorp/aws versions matching "~> 5.0"...
- Finding hashicorp/random versions matching "~> 3.6"...
- Using previously-installed hashicorp/aws v5.100.0
- Using previously-installed hashicorp/random v3.7.2

[0m[1m[32mTerraform has been successfully initialized![0m[32m[0m
[0m[32m
You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.[0m
===== [2] Terraform validate =====
[32m[1mSuccess![0m The configuration is valid.
[0m
===== [3] Terraform plan =====

Terraform used the selected providers to generate the following execution
plan. Resource actions are indicated with the following symbols:
  [32m+[0m create[0m

Terraform will perform the following actions:

[1m  # aws_db_instance.rds[0m will be created
[0m  [32m+[0m[0m resource "aws_db_instance" "rds" {
      [32m+[0m[0m address                               = (known after apply)
      [32m+[0m[0m allocated_storage                     = 20
      [32m+[0m[0m apply_immediately                     = false
      [32m+[0m[0m arn                                   = (known after apply)
      [32m+[0m[0m auto_minor_version_upgrade            = true
      [32m+[0m[0m availability_zone                     = (known after apply)
      [32m+[0m[0m backup_retention_period               = 7
      [32m+[0m[0m backup_target                         = (known after apply)
      [32m+[0m[0m backup_window                         = (known after apply)
      [32m+[0m[0m ca_cert_identifier                    = (known after apply)
      [32m+[0m[0m character_set_name                    = (known after apply)
      [32m+[0m[0m copy_tags_to_snapshot                 = false
      [32m+[0m[0m database_insights_mode                = (known after apply)
      [32m+[0m[0m db_name                               = (known after apply)
      [32m+[0m[0m db_subnet_group_name                  = (known after apply)
      [32m+[0m[0m dedicated_log_volume                  = false
      [32m+[0m[0m delete_automated_backups              = true
      [32m+[0m[0m deletion_protection                   = false
      [32m+[0m[0m domain_fqdn                           = (known after apply)
      [32m+[0m[0m endpoint                              = (known after apply)
      [32m+[0m[0m engine                                = "mysql"
      [32m+[0m[0m engine_lifecycle_support              = (known after apply)
      [32m+[0m[0m engine_version                        = "8.0"
      [32m+[0m[0m engine_version_actual                 = (known after apply)
      [32m+[0m[0m hosted_zone_id                        = (known after apply)
      [32m+[0m[0m id                                    = (known after apply)
      [32m+[0m[0m identifier                            = (known after apply)
      [32m+[0m[0m identifier_prefix                     = (known after apply)
      [32m+[0m[0m instance_class                        = "db.t3.micro"
      [32m+[0m[0m iops                                  = (known after apply)
      [32m+[0m[0m kms_key_id                            = (known after apply)
      [32m+[0m[0m latest_restorable_time                = (known after apply)
      [32m+[0m[0m license_model                         = (known after apply)
      [32m+[0m[0m listener_endpoint                     = (known after apply)
      [32m+[0m[0m maintenance_window                    = (known after apply)
      [32m+[0m[0m master_user_secret                    = (known after apply)
      [32m+[0m[0m master_user_secret_kms_key_id         = (known after apply)
      [32m+[0m[0m monitoring_interval                   = 0
      [32m+[0m[0m monitoring_role_arn                   = (known after apply)
      [32m+[0m[0m multi_az                              = (known after apply)
      [32m+[0m[0m nchar_character_set_name              = (known after apply)
      [32m+[0m[0m network_type                          = (known after apply)
      [32m+[0m[0m option_group_name                     = (known after apply)
      [32m+[0m[0m parameter_group_name                  = (known after apply)
      [32m+[0m[0m password                              = (sensitive value)
      [32m+[0m[0m password_wo                           = (write-only attribute)
      [32m+[0m[0m performance_insights_enabled          = false
      [32m+[0m[0m performance_insights_kms_key_id       = (known after apply)
      [32m+[0m[0m performance_insights_retention_period = (known after apply)
      [32m+[0m[0m port                                  = (known after apply)
      [32m+[0m[0m publicly_accessible                   = false
      [32m+[0m[0m replica_mode                          = (known after apply)
      [32m+[0m[0m replicas                              = (known after apply)
      [32m+[0m[0m resource_id                           = (known after apply)
      [32m+[0m[0m skip_final_snapshot                   = true
      [32m+[0m[0m snapshot_identifier                   = (known after apply)
      [32m+[0m[0m status                                = (known after apply)
      [32m+[0m[0m storage_encrypted                     = false
      [32m+[0m[0m storage_throughput                    = (known after apply)
      [32m+[0m[0m storage_type                          = (known after apply)
      [32m+[0m[0m tags                                  = {
          [32m+[0m[0m "cis_controls" = "RDS.3"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-005-005-rds-unencrypted-no-delettion-protection"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m tags_all                              = {
          [32m+[0m[0m "cis_controls" = "RDS.3"
          [32m+[0m[0m "domain"       = "STO"
          [32m+[0m[0m "scenario_id"  = "STO-MISC-005-005-rds-unencrypted-no-delettion-protection"
          [32m+[0m[0m "type"         = "MISC"
        }
      [32m+[0m[0m timezone                              = (known after apply)
      [32m+[0m[0m username                              = "adminuser"
      [32m+[0m[0m vpc_security_group_ids                = (known after apply)
    }

[1m  # random_id.suffix[0m will be created
[0m  [32m+[0m[0m resource "random_id" "suffix" {
      [32m+[0m[0m b64_std     = (known after apply)
      [32m+[0m[0m b64_url     = (known after apply)
      [32m+[0m[0m byte_length = 4
      [32m+[0m[0m dec         = (known after apply)
      [32m+[0m[0m hex         = (known after apply)
      [32m+[0m[0m id          = (known after apply)
    }

[1m  # random_password.db[0m will be created
[0m  [32m+[0m[0m resource "random_password" "db" {
      [32m+[0m[0m bcrypt_hash = (sensitive value)
      [32m+[0m[0m id          = (known after apply)
      [32m+[0m[0m length      = 16
      [32m+[0m[0m lower       = true
      [32m+[0m[0m min_lower   = 0
      [32m+[0m[0m min_numeric = 0
      [32m+[0m[0m min_special = 0
      [32m+[0m[0m min_upper   = 0
      [32m+[0m[0m number      = true
      [32m+[0m[0m numeric     = true
      [32m+[0m[0m result      = (sensitive value)
      [32m+[0m[0m special     = true
      [32m+[0m[0m upper       = true
    }

[1mPlan:[0m [0m3 to add, 0 to change, 0 to destroy.
[90m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m

Saved the plan to: tfplan.binary

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan.binary"

===== [4] Export plan to JSON =====

===== [5] Checkov =====

       _               _
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V /
  \___|_| |_|\___|\___|_|\_\___/ \_/

By Prisma Cloud | version: 3.2.495 

terraform scan results:

Passed checks: 7, Failed checks: 8, Skipped checks: 0

Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /provider.tf:1-9
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /main.tf:8-26
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /main.tf:8-26

		8  | resource "aws_db_instance" "rds" {
		9  |   identifier        = lower(format("%s-%s", substr(var.scenario_id, 0, 40), local.name_suffix))
		10 |   engine            = "mysql"
		11 |   engine_version    = "8.0"
		12 |   instance_class    = "db.t3.micro"
		13 |   allocated_storage = 20
		14 | 
		15 |   username = "adminuser"
		16 |   password = random_password.db.result
		17 | 
		18 |   storage_encrypted    = false
		19 |   deletion_protection  = false
		20 | 
		21 |   backup_retention_period = 7
		22 |   skip_final_snapshot     = true
		23 |   publicly_accessible     = false
		24 | 
		25 |   tags = local.common_tags
		26 | }

terraform_plan scan results:

Passed checks: 8, Failed checks: 7, Skipped checks: 0

Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
	PASSED for resource: aws.default
	File: /tfplan.json:0-1
Check: CKV_AWS_354: "Ensure RDS Performance Insights are encrypted using KMS CMKs"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_133: "Ensure that RDS instances has backup policy"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_388: "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_211: "Ensure RDS uses a modern CaCert"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_17: "Ensure all data stored in RDS is not publicly accessible"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_69: "Ensure AWS RDS database instance configured with encryption in transit"
	PASSED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0
Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.rds
	File: /tfplan.json:0-0


===== [6] tfsec =====

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mInstance does not have storage encryption enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:18
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[90m    8  [0m[0m  [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[90m    .  [0m
[0m[31m   18  [0m[0m[31m[[39m[0m[0m   [38;5;245mstorage_encrypted[0m    = [38;5;166mfalse[0m[0m [3m[2m[3m(false)[0m
[0m[90m   ..  [0m
[0m[90m   26  [0m[0m  }[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-encrypt-instance-storage-data
[0m[0m  [2m    Impact[0m Data can be read from RDS instances if compromised
[0m[0m  [2mResolution[0m Enable encryption for RDS instances
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #2[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have Deletion Protection enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:19
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m   19  [0m[0m [0m[0m [0m  [38;5;245mdeletion_protection[0m  = [38;5;166mfalse[0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0177
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #3[0m [0m[33mMEDIUM[39m[0m [1mInstance does not have IAM Authentication enabled[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2mRego Package[0m[3m builtin.aws.rds.aws0176
[0m[0m  [2m   Rego Rule[0m[3m deny[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m[3mResult #4[0m [0m[97mLOW[39m[0m [1mInstance does not have performance insights enabled.[0m [2m[0m
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [3mmain.tf[2m[3m:8-26
[0m[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m[31m    8  [0m[0m[31mâ”Œ[39m[0m[0m [38;5;33mresource[0m [38;5;37m"aws_db_instance"[0m [38;5;37m"rds"[0m {[0m
[0m[31m    9  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245midentifier[0m        = [38;5;33mlower[0m([38;5;33mformat[0m([38;5;37m"%s-%s"[0m, [38;5;33msubstr[0m([38;5;33mvar[0m.scenario_id, [38;5;37m0[0m, [38;5;37m40[0m), local.name_suffix))[0m
[0m[31m   10  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245mengine[0m            = [38;5;37m"mysql"[0m
[0m[31m   11  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mengine_version[0m    = [38;5;37m"8.0"[0m
[0m[31m   12  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245minstance_class[0m    = [38;5;37m"db.t3.micro"[0m
[0m[31m   13  [0m[0m[31mâ”‚[39m[0m[0m [0m  [38;5;245mallocated_storage[0m = [38;5;37m20[0m
[0m[31m   14  [0m[0m[31mâ”‚[39m[0m[0m [0m[0m
[0m[31m   15  [0m[0m[31mâ”‚[39m[0m[0m   [38;5;245musername[0m = [38;5;37m"adminuser"[0m
[0m[31m   16  [0m[0m[31mâ””[39m[0m[0m [0m  [38;5;245mpassword[0m = random_password.db.result[0m
[0m[90m   ..  [0m
[0m[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[0m[0m  [2m        ID[0m[3m aws-rds-enable-performance-insights
[0m[0m  [2m    Impact[0m Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
[0m[0m  [2mResolution[0m Enable performance insights
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id[0m[0m
[90mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 72.132Âµs
[0m[0m  [2mparsing             [0m 918.77Âµs
[0m[0m  [2madaptation          [0m 114.429Âµs
[0m[0m  [2mchecks              [0m 27.920481ms
[0m[0m  [2mtotal               [0m 29.025812ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 12
[0m[0m  [2mfiles read          [0m 5
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 3
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 1
[0m[0m  [2mmedium              [0m 2
[0m[0m  [2mlow                 [0m 1
[0m
[0m  [31m[1m3 passed, 4 potential problem(s) detected.

[0m
===== [7] Terrascan =====

===== [8] Conftest =====
[31mFAIL[0m - tfplan.json - main - No aws_cloudtrail resource detected in plan (CloudTrail logging not enabled)
[31mFAIL[0m - tfplan.json - main - No aws_flow_log resources detected in plan (VPC Flow Logs likely not enabled)

[31m21 tests, 19 passed, 0 warnings, 2 failures, 0 exceptions[0m

============================================================
FULL SCAN LOG END: 2025-12-22 03:06:37 UTC
Return codes:
  checkov   = 1
  tfsec     = 1
  terrascan = 1
  conftest  = 1
Master log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/test-suite/storage/STO-MISC-005-rds-unencrypted-no-deletion-protection/scan_logs/FULL_STO-MISC-005-rds-unencrypted-no-deletion-protection.log
============================================================


============================================================
Experiment complete.
âž¡ Summary: /workspaces/MSc-Thesis---Cloud-Misconfigurations/results/summary.csv
âž¡ Per-scenario JSON: /workspaces/MSc-Thesis---Cloud-Misconfigurations/results/<scenario_id>/aggregated.json
âž¡ Full experiment log: /workspaces/MSc-Thesis---Cloud-Misconfigurations/results/logs/FULL_EXPERIMENT_20251222_025803.log
============================================================
